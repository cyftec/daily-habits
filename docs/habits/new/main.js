var RX=["onmount","onunmount"],FX=["onerror","onload","onresize","onblur","onchange","oncontextmenu","onfocus","oninput","oninvalid","onreset","onselect","onsubmit","onkeydown","onkeypress","onkeyup","onclick","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onscroll","onabort","oncanplay","oncanplaythrough","ondurationchange","onemptied","onended","onerror","onloadeddata","onloadedmetadata","onloadstart","onpause","onplay","onplaying","onprogress","onratechange","onseeked","onseeking","onstalled","onsuspend","ontimeupdate","onvolumechange","onwaiting"],IX=[...FX,...RX],gX=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"],u,yX=(X)=>{if(!u)u=document.createElement("textarea");return u.innerHTML=X,u.value},bX=()=>{let X=0;return{getNewId:()=>++X,resetIdCounter:()=>X=0}},PX=bX(),E={currentIs:(X)=>window._currentAppPhase===X,start:(X)=>{window._currentAppPhase=X,console.log(`Current phase is ${X}`)}},n=(X)=>{let Z=Object.entries(X).sort(($,J)=>$[0].localeCompare(J[0]));return Z.forEach(([$,J],Q)=>{if(J&&typeof J==="object"&&!Array.isArray(J))Z[Q]=[$,n(J)]}),Object.fromEntries(Z)},l=(X)=>{if(typeof X!=="object"||X===null||Array.isArray(X))return!1;return Object.prototype.toString.call(X)==="[object Object]"},m=(X)=>{if(Array.isArray(X)){let Z=[...X],$=[];return Z.forEach((J)=>{$.push(m(J))}),$}if(l(X)){let Z={...X},$={};return Object.keys(Z).forEach((J)=>{$[J]=m(Z[J])}),Object.freeze($)}return X},y=(X)=>{if(Array.isArray(X)){let $=[...X],J=[];return $.forEach((Q)=>{J.push(y(Q))}),J}if(l(X)){let $={...X},J={};return Object.keys($).forEach((Q)=>{J[Q]=y($[Q])}),J}return X},JX=(X,Z="index")=>X.map(($,J)=>({[Z]:J,value:$})),cX=(X,Z)=>{let $=n(X),J=n(Z),Q=Object.keys($),z=Object.keys(J);if(Q.length!==z.length)return!1;for(let Y of Q)if(!z.includes(Y)||!t($[Y],J[Y]))return!1;return!0},hX=(X,Z)=>{if(X.length!==Z.length)return!1;if(X.length===0)return!0;for(let $=0;$<X.length;$++)if(!t(X[$],Z[$]))return!1;return!0},t=(X,Z)=>{if(typeof X!==typeof Z)return!1;if(Array.isArray(X))return hX(X,Z);if(X===null||Z===null)return X===Z;if(typeof X==="object"&&!(X instanceof Set))return cX(X,Z);if(typeof X==="bigint"||typeof X==="number"||typeof X==="string"||typeof X==="boolean")return X===Z;return X===Z},vX=(X,Z,$)=>{let Q=JX(y(X),"index");return JX(y(Z),"index").map((Y)=>{let U="add",_=-1,F=Y.value;return Q.some((G,K)=>{if(U=t(G.value,Y.value)?G.index===Y.index?"idle":"shuffle":$&&G.value[$]!==void 0&&G.value[$]===Y.value[$]?"update":"add",U!=="add")return _=G.index,Q.splice(K,1),!0;return!1}),{type:U,oldIndex:_,value:F}})},O=(X)=>["source-signal","derived-signal"].includes(X?.type),DX=(X,Z)=>X?.type==="non-signal"&&(!Z||!Z.length||Z.some(($)=>typeof X?.value===$)),e=(X)=>O(X)||DX(X),KX=(X)=>DX(X,["string"]),jX=(X)=>X?.type==="non-signal"&&Array.isArray(X?.value)&&(X?.value).every((Z)=>typeof Z==="string"),b=(X)=>e(X)?X.value:X,s=null,V=(X)=>{let Z=m(X),$=new Set;return{type:"source-signal",get value(){if(s)$.add(s);return y(Z)},set value(J){if(J===Z)return;Z=m(J),$.forEach((Q)=>Q&&Q())}}},I=(X)=>{s=X,X(),s=null},B=(X)=>{let Z,$=V(Z);return I(()=>{Z=X(Z),$.value=Z}),{type:"derived-signal",get prevValue(){return Z},get value(){return $.value}}},HX=(X)=>{if(!l(X.value))throw new Error("Thee argument should be a plain object or a signal of plain object");return{prop:(Z)=>B(()=>X.value[Z]),get props(){return Object.keys(X.value).reduce(($,J)=>{let Q=J;return $[Q]=this.prop(Q),$},{})}}},P=(X,...Z)=>B(()=>{return X.reduce(($,J,Q)=>{let z,Y=Z[Q];if(typeof Y==="function")z=Y()??"";else if(e(Y))z=Y.value??"";else z=Y??"";return`${$}${J}${z.toString()}`},"")}),r=(X)=>Array.isArray(X),o=(X)=>!isNaN(X?.elementId)&&X?.elementId>0,g=(X)=>typeof X==="string"||typeof X==="function"&&X.isElementGetter,XX=(X)=>O(X)&&g(X.value),uX=(X)=>g(X)||XX(X),fX=(X)=>{return O(X)&&(g(X.value)||r(X.value)&&X.value.every((Z)=>g(Z)))},kX=(X)=>{return!O(X)&&(KX(X)||jX(X)||g(X)||r(X)&&X.every((Z)=>uX(Z)))},ZX=(X)=>{return fX(X)||kX(X)},QX=!1,pX={},C={},mX=globalThis.MutationObserver,sX=new mX((X)=>{X.forEach((Z)=>{if(Z.type==="childList")Z.addedNodes.forEach(($)=>{if(o($)){let J=$,Q=J.elementId;if(C[Q])delete C[Q];else pX[Q]=J.tagName}}),Z.removedNodes.forEach(($)=>{if(o($)){let J=$,Q=J.elementId,z=J.unmountListener;if(z)C[Q]={element:J,unmountListener:z}}})}),Object.entries(C).forEach(([Z,$])=>{let{element:J,unmountListener:Q}=$;wX(J,Q)})}),wX=(X,Z)=>{if(!o(X))return;let $=X.children;for(let J=0;J<$.length;J++){let Q=$[J];wX(Q,Q.unmountListener)}if(Z&&Z(X),C[X.elementId])delete C[X.elementId]},rX=()=>{if(!QX&&!E.currentIs("build"))sX.observe(document.body,{childList:!0,subtree:!0}),QX=!0},TX=(X,Z)=>IX.includes(X)&&Z===void 0,AX=(X,Z)=>FX.includes(X)&&typeof Z==="function",MX=(X,Z)=>RX.includes(X)&&typeof Z==="function",oX=(X,Z)=>TX(X,Z)||AX(X,Z)||MX(X,Z),dX=(X,Z)=>{Object.entries(Z).forEach(([$,J])=>{if(TX($,J));else if(AX($,J)){let Q=$.slice(2);X.addEventListener(Q,(z)=>{if(Q==="keypress")z.preventDefault();J(z)})}else if(MX($,J)){if($==="onmount"&&!E.currentIs("build")){let Q=J;setTimeout(()=>Q(X),0)}if($==="onunmount")rX(),X.unmountListener=J}else console.error(`Invalid event key: ${$} for element with tagName: ${X.tagName}`)})},WX=(X,Z,$)=>{let J=(e($)?$.value:$)??"";if(typeof J==="boolean")if(J)X.setAttribute(Z,"");else X.removeAttribute(Z);else if(Z==="value")X.value=J;else if(J)X.setAttribute(Z,J)},iX=(X,Z)=>{let $={};Object.entries(Z).forEach((J)=>{let[Q,z]=J;if(O(z))$[Q]=z;WX(X,Q,z)}),I(()=>{Object.entries($).forEach((J)=>{let[Q,z]=J,Y=z.value;if(!E.currentIs("run"))return;WX(X,Q,Y)})})},p=(X)=>{if(XX(X)){let Z=X.value;return p(Z)}if(typeof X==="string")return document.createTextNode(yX(X));if(g(X)){let Z=X();if(!o(Z))throw new Error(`Invalid MHtml element getter child. Type: ${typeof X}`);return Z}throw new Error(`Invalid child. Type of child: ${typeof X}`)},nX=(X,Z)=>{if(!Z)return;if(fX(Z))I(()=>{let J=Z.value,Q=r(J)?J:[J];Q.forEach((Y,U)=>{let _=X.childNodes[U],F=p(Y);if(_&&F)X.replaceChild(F,_);else if(F)X.appendChild(F);else console.error(`No child found for node with tagName: ${X.tagName}`)});let z=Q.length;while(z<X.childNodes.length){let Y=X.childNodes[z];if(Y)X.removeChild(Y)}});if(kX(Z)){let $=KX(Z)?[Z.value]:jX(Z)?Z.value:r(Z)?Z:[Z],J=[];if($.forEach((Q,z)=>{if(XX(Q))J.push({index:z,childSignal:Q});let Y=p(Q),U=X.childNodes[z];if(U&&Y)X.replaceChild(Y,U);else if(!U&&Y)X.appendChild(Y);else console.error(`No child found for node with tagName: ${X.tagName}`)}),J.length)J.forEach(({index:Q,childSignal:z})=>{I(()=>{if(!z.value)return;if(!E.currentIs("run"))return;let Y=p(z.value),U=X.childNodes[Q];if(U&&Y)X.replaceChild(Y,U);else if(!U&&Y)X.appendChild(Y);else console.error(`No child found for node with tagName: ${X.tagName}`)})})}},aX=(X,Z)=>{let $=void 0,J={},Q={};return Object.entries(X).forEach(([z,Y])=>{if(z==="children")if(ZX(Y))$=Y;else if(Y===void 0)$=Y;else throw new Error(`Invalid children prop for node with tagName: ${Z}

 ${JSON.stringify(Y)}`);else if(oX(z,Y))J[z]=Y;else Q[z]=Y}),{children:$,eventProps:J,attributeProps:Q}},lX=(X,Z)=>{let $=()=>{let J=PX.getNewId(),Q=E.currentIs("mount")?document.querySelector(`[data-elem-id="${J}"]`):document.createElement(X);Q.elementId=J,Q.unmountListener=void 0;let z=ZX(Z)?{children:Z}:Z;if(!E.currentIs("run"))z["data-elem-id"]=Q.elementId.toString();let Y=aX(z,Q.tagName);if(dX(Q,Y.eventProps),iX(Q,Y.attributeProps),nX(Q,Y.children),!E.currentIs("build"))Q.removeAttribute("data-elem-id");return Q};return $.isElementGetter=!0,$},YX=(X,Z,$)=>{let J=V(Z),Q=V(X),z=$(B(()=>Q.value),B(()=>J.value)),Y,U,_=!1;if(z?.isElementGetter)Y=()=>{if(_&&U)return U;return U=z(),_=!0,U},Y.isElementGetter=!0;else if(typeof z==="string")Y=z;else throw`One of the child, ${z} passed in ForElement is invalid.`;return{indexSignal:J,itemSignal:Q,mappedChild:Y}},zX=(X,Z,$)=>{if(Z!==void 0&&Z>=0&&$){let J=Z>X.length?X.length:Z;X.splice(J,0,$)}return X},tX=({subject:X,itemKey:Z,map:$,n:J,nthChild:Q})=>{if(Q&&J===void 0||J!==void 0&&J>-1&&!Q)throw new Error("Either both 'n' and 'nthChild' be passed or none of them.");let z=B(()=>{let D=b(X);return Array.isArray(D)?D:[]});if(!Z)return B(()=>zX(z.value.map($),J,Q));let Y=Q;if(Q&&typeof Q!=="string"){let D=Q(),j=()=>D;j.isElementGetter=!0,Y=j}let U=z.value;if(U.length&&typeof U[0]!=="object")throw new Error("for mutable map, item in the list must be an object");let _=null,F=B((D)=>{return _=D||_,z.value}),G=B((D)=>{if(!D||!_)return F.value.map((A,w)=>YX(A,w,$));return vX(_,F.value,Z).map((f,A)=>{let w=(D||[])[f.oldIndex];if(console.assert(f.type==="add"&&f.oldIndex===-1&&!w||f.oldIndex>-1&&!!w,"In case of mutation type 'add' oldIndex should be '-1', or else oldIndex should always be a non-negative integer."),w){if(f.type==="shuffle")w.indexSignal.value=A;if(f.type==="update")w.indexSignal.value=A,w.itemSignal.value={...f.value};return w}return YX(f.value,A,$)})});return B(()=>zX(G.value.map((D)=>D.mappedChild),J,Y))},eX=({subject:X,isTruthy:Z,isFalsy:$})=>{let J=W.Span({style:"display: none;"}),Q=()=>(b(X)?Z:$)||J;return O(X)?B(Q):Q()},XZ=({subject:X,caseMatcher:Z,defaultCase:$,cases:J})=>{let Q=()=>{let z=b(X),Y=void 0;for(let[U,_]of Object.entries(J))if(Z&&Z(X,U)||z===U){Y=_;break}return Y||$||W.Span({style:"display: none;"})};return O(X)?B(Q):Q()},ZZ=gX.reduce((X,Z)=>{let $=Z.split("").map((Q,z)=>!z?Q.toUpperCase():Q).join(""),J=(Q)=>lX(Z,Q);return X[$]=J,X},{}),$Z={For:tX,If:eX,Switch:XZ},W={...ZZ,...$Z},k=(X)=>(Z)=>{for(let J of Object.keys(Z))if(Z[J]===void 0)delete Z[J];let $=Object.entries(Z).reduce((J,Q)=>{let[z,Y]=Q,U=typeof Y==="string",_=Array.isArray(Y)&&Y.every((G)=>typeof G==="string"),F=O(Y)||typeof Y==="function"?Y:U||_?{type:"non-signal",get value(){return b(Y)}}:ZX(Y)?Y:{type:"non-signal",get value(){return b(Y)}};return J[z]=F,J},{});return X($)},JZ=86400000,QZ=1.6181,LX={id:"local-settings",habitsPage:{tabIndex:0,sortOptionIndex:0}},UX=[{icon:"calendar_month",decending:!0,label:"Date created (Newest first)"},{icon:"calendar_month",decending:!1,label:"Date created (Oldest first)"},{icon:"task_alt",decending:!0,label:"Completion (Highest first)"},{icon:"task_alt",decending:!1,label:"Completion (Lowest first)"}],WZ=[1,1,1,1,1,1,1],YZ=["Not done","Done"],zZ=[90,75,50],UZ=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],qZ=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],GZ=["January","February","March","April","May","June","July","August","September","October","November","December"],VX=["#e87b52","#F5B971","#F5E06F","#A3BA64","#679A9E","#7095C9","#A59EE3","#D89DBF"],BZ=(X)=>{let Z=new Date().getTime();return{id:X?Z-JZ*X:Z,title:"",frequency:WZ,colorIndex:0,levels:YZ,tracker:[],milestones:zZ,pauses:[],isStopped:!1}},SX=(X)=>[{label:"Successful",percent:X[0],icon:"verified_user",color:"green"},{label:"Little more to go",percent:X[1],icon:"done_all",color:"light-blue"},{label:"Going good",percent:X[2],icon:"check",color:"blue"},{label:"Unacceptable",percent:0,icon:"close",color:"red"}],qX=(X,Z)=>{let $=SX(X),J=$[0];for(let Q=0;Q<$.length;Q++)if(J=$[Q],J.percent<Z)break;return J},_Z=(X)=>{if(!X.title)return"Title should not be empty";if(X.frequency.every((Z)=>!Z))return"Select at least one day in a week";if(!X.levels.every((Z)=>!!Z))return"One of the levels is empty";if(!X.milestones.every((Z)=>Z<=100&&Z>=0))return"The milestones should be between 0 and 100 percents";if(!X.milestones.every((Z,$,J)=>$===0?!0:J[$-1]>Z))return"Milestones should be in order (from high to low)";return""},RZ=()=>{if(!location)return[];return location.href.split("?")[1].split("&")},FZ=(X,Z)=>{let{id:$,tracker:J}=X,Q=Z.getFullYear(),z=Z.getMonth(),Y=[...UZ],U=new Date($),_=U.getFullYear(),F=U.getMonth(),G=U.getDate();for(let K=0;K<J.length;K++){let D=new Date(_,F,G+K),j=D.getFullYear(),f=D.getMonth();if(j>Q)break;if(j===Q&&f>z)break;if(j===Q&&f===z){let A=D.getDate();Y[A-1]=J[K]}}return Y},PZ=(X,Z)=>{let $=new Date;return Array(Z).fill(0).map((Q,z)=>new Date($.getFullYear(),$.getMonth()-z,1)).reverse().map((Q)=>({monthIndex:Q.getMonth(),status:FZ(X,Q)}))},T=(X)=>{return(...Z)=>{if(window.navigator?.vibrate)window.navigator.vibrate(3);return X&&X(...Z)}},DZ=k(({classNames:X,hideRemove:Z,hideAdd:$,onRemove:J,onAdd:Q})=>{return W.Span({class:P`br3 pb1 f4 bw1 b--light-silver dark-gray ${()=>Z?.value&&$?.value?"bn":"ba"} ${X}`,children:[W.If({subject:Z,isFalsy:W.Span({class:P`pointer ph2 pb1 bw1 b--light-silver ${()=>$?.value?"":"br"}`,onclick:T(J),children:"-"})}),W.If({subject:$,isFalsy:W.Span({class:"pointer ph2 pb1",onclick:T(Q),children:"+"})})]})}),x=k(({className:X,onTap:Z,children:$})=>W.Button({class:P`pointer br-pill ba bw1 b--light-silver b--hover-black bg-white black ${X}`,onclick:T(()=>Z()),children:$})),EX=k(({classNames:X,colorIndex:Z,level:$,totalLevels:J,textContent:Q,showText:z,onClick:Y})=>{let U=B(()=>VX[Z.value]),_=B(()=>Math.trunc(Math.pow($.value/(J.value-1),QZ)*255)),F=B(()=>{let D=_.value.toString(16);return D.length===1?`0${D}`:D}),G=B(()=>$.value<0||F.value==="0"?"transparent":`${U.value}${F.value}`),K=B(()=>z?.value?$.value/(J.value-1)>0.5?"white":"black":$.value<0?"lightgray":"transparent");return W.Span({class:P`pointer br-100 relative ${()=>$.value<0?"transparent":"bg-near-white"} ${X}`,onclick:T(()=>Y&&$.value>=0&&Y()),children:[W.Span({class:P`flex items-center justify-around absolute absolute--fill br-100 pt05`,style:P`
            background-color: ${G};
            color: ${K};
          `,children:B(()=>Q?.value||"·")})]})}),c=k(({className:X,size:Z,onClick:$,iconName:J,title:Q})=>W.Span({class:P`material-symbols-rounded ${()=>$?"pointer":""} ${X}`,style:P`font-size: ${()=>Z?.value||"16"}px`,onclick:T($),children:J,title:Q})),GX=k(({classNames:X,href:Z,target:$,onClick:J,children:Q})=>{return W.A({class:P`${()=>!Z&&!J?"":"pointer underline"} ${X}`,href:Z,target:$,onclick:T(J),children:Q})}),a=k(({classNames:X,isOpen:Z,content:$,onTapOutside:J})=>{return W.Dialog({onmount:(Q)=>setTimeout(()=>I(()=>{if(Z.value)Q.showModal();else Q.close()})),onclick:T(J),class:P`pa0 br3 ${X}`,children:[W.Div({onclick:(Q)=>Q.stopPropagation(),children:$})]})}),KZ=k(({classNames:X,placeholder:Z,num:$,onchange:J})=>{let Q=(z)=>{let Y=z.target.value,U=Number.parseFloat(Number.parseFloat(Y||"0").toFixed(2));J(U)};return W.Input({class:X,type:"number",placeholder:Z,value:P`${()=>$.value??""}`,onchange:Q})}),jZ=k(({classNames:X,body:Z,onMount:$})=>{return W.Html({lang:"en",children:[W.Head({children:[W.Title("Maya App"),W.Meta({charset:"UTF-8"}),W.Meta({"http-equiv":"X-UA-Compatible",content:"IE=edge"}),W.Meta({name:"viewport",content:"width=device-width, initial-scale=1.0"}),W.Link({rel:"stylesheet",href:"/assets/styles.css"})]}),W.Body({class:X,onmount:$,children:[W.Script({src:"main.js",defer:"true"}),Z]})]})}),xZ=k(({progress:X,classNames:Z})=>{let $=P`width: ${()=>X.value<0?0:X.value>100?100:X.value}%;`;return W.Div({class:P`br-pill bg-moon-gray ${Z}`,children:W.Div({class:"br-pill bg-app-theme-color pa1",style:$})})}),HZ=k(({classNames:X,header:Z,content:$,bottombar:J})=>{return W.Div({class:"flex-ns justify-center-ns",children:W.Div({class:P`w6-ns ${X}`,children:[W.If({subject:Z,isTruthy:W.Div({class:"overflow-break-word sticky top-0 left-0 right-0 bg-inherit z-999 f2dot33 b pv3 mt2",children:Z})}),$,W.Div({class:"pv6 mt5"}),W.If({subject:J,isTruthy:W.Div({class:"sticky bottom-0 left-0 right-0 z-9999",children:J})})]})})}),NZ=k(({classNames:X,tabItemClassNames:Z,selectedTabClassNames:$,tabs:J,selectedTabIndex:Q,onTabChange:z})=>{return W.Div({class:P`bg-near-white br3 ${X}`,children:W.Div({class:"flex items-center justify-between pa1",children:W.For({subject:J,map:(Y,U)=>W.Span({class:P`w-100 br3 pa1 flex justify-center ${()=>U===Q.value?`bg-white black ${$?.value}`:"bg-transparent silver pointer"} ${Z}`,onclick:T(()=>z(U)),children:Y})})})})}),BX=k(({classNames:X,placeholder:Z,disabled:$,text:J,onmount:Q,onchange:z,onkeydown:Y,onfocus:U,onblur:_})=>{let F,G=(j)=>{if(F=j,Q)Q(j)},K=(j)=>{let f=j.target.value;if(z)z(f)},D=(j)=>{let f=j.key.length===1?F.value+j.key:j.key==="Backspace"?F.value.slice(0,-1):F.value,A={key:j.key,text:f};if(Y)Y(A)};return W.Input({onmount:G,class:P`${X}`,type:"text",placeholder:Z,disabled:$,value:J,onchange:K,onkeydown:D,onfocus:U,onblur:_})}),fZ=k(({classNames:X,status:Z,month:$,colorIndex:J,totalLevels:Q})=>{return W.Div({class:P`flex items-center ${X}`,children:[W.Div({class:"f8 b w1 light-silver",children:B(()=>$.value.charAt(0))}),W.Div({class:"w-100 flex items-center justify-between",children:W.For({subject:Z,map:(z)=>EX({classNames:"pa1",colorIndex:J,level:z,totalLevels:Q})})})]})}),CZ=k(({classNames:X,habit:Z,months:$,onClick:J})=>{let{milestones:Q,title:z,completion:Y,colorIndex:U,levels:_}=HX(B(()=>Z.value)).props,F=B(()=>PZ(Z.value,$.value)),G=B(()=>qX(Q.value,Y.value).icon),K=B(()=>qX(Q.value,Y.value).color);return W.Div({class:P`pointer bg-white br4 pa3 ${X}`,onclick:T(J),children:[W.Div({class:"flex items-center justify-between nt1 mb2",children:[W.Div({class:"f4 dark-gray b",children:z}),W.Div({class:"f6 silver b flex items-center",children:[c({className:P`mr1 ${K}`,iconName:G}),P`${Y}%`]})]}),W.Div({class:"mt3 mb1",children:W.For({subject:F,map:(D)=>fZ({classNames:"mb1",month:GZ[D.monthIndex],status:D.status,colorIndex:U,totalLevels:_.value.length})})})]})}),kZ=k(({classNames:X,habit:Z,initialLevels:$,onChange:J})=>{let{title:Q,frequency:z,levels:Y,milestones:U,colorIndex:_}=HX(Z).props,F=B(()=>z.value.every((q)=>!!q)),G="bg-mid-gray white",K="bg-near-white light-silver",D=(q)=>{J({...Z.value,title:q})},j=(q)=>{J({...Z.value,colorIndex:q})},f=(q)=>{if(q<-1||q>6)throw"Invalid day index";if(q===-1){J({...Z.value,frequency:[1,1,1,1,1,1,1]});return}let R=F.value?z.value.map((H)=>0):z.value;R[q]=F.value?1:R[q]?0:1,J({...Z.value,frequency:R})},A=(q,R)=>{let H=Y.value;H[R]=q,J({...Z.value,levels:H})},w=(q,R=!0)=>{let H=Y.value;if(R)H.splice(q,0,"");else H.splice(q,1);J({...Z.value,levels:H})},L=(q)=>w(q),M=(q)=>{if(Y.value.length<3)return;w(q,!1)},S=(q,R)=>{if(R<0||R>2)throw"Incorrect index of milestone passed. Milestone values should not be more than 3.";let H=[...Z.value.milestones];H[R]=q,J({...Z.value,milestones:H})};return W.Div({class:X,children:[N({title:"Color",child:W.Div({class:"mb1 flex items-center justify-between justify-start-ns",children:W.For({subject:VX,map:(q,R)=>{let H=B(()=>R===_.value?"#999":"#f4f4f4");return W.Span({class:"pointer mb2 mr3-ns pa1 br-100 bw2 ba flex",style:P`border-color: ${H}`,onclick:T(()=>j(R)),children:W.Span({class:P`pa2 br-100`,style:`background-color: ${q}`})})}})})}),N({classNames:"pb1",title:"Title",child:BX({classNames:"ba bw1 b--light-silver br3 pa2 w-100",placeholder:"title of target habit",text:Q,onchange:D})}),N({classNames:"pb1",title:"Frequency",child:W.Div({class:"mb3 f6 flex items-center justify-between justify-start-ns",children:W.For({subject:qZ,n:0,nthChild:W.Span({class:P`pointer flex items-center justify-center br-pill h2 ph2 mr3-ns ${()=>F.value?"bg-mid-gray white":"bg-near-white light-silver"}`,children:"Daily",onclick:T(()=>f(-1))}),map:(q,R)=>{let H=B(()=>z.value[R]&&!F.value?"bg-mid-gray white":"bg-near-white light-silver");return W.Span({class:P`pointer flex items-center justify-center br-100 h2 w2 mr3-ns ${H}`,children:q.charAt(0),onclick:T(()=>f(R))})}})})}),N({classNames:"pb3",title:"Levels",child:W.Div({children:W.For({subject:Y,map:(q,R)=>{let H=Z.value.levels.length<3,h=!!($.value.length&&$.value.includes(q)),d=!!($.value.length&&$.value.length!==Z.value.levels.length),v=Z.value.levels.length<$.value.length,$X=$.value.length&&!d&&!$.value.every((i,CX)=>i===Z.value.levels[CX]),OX=v||$X||d&&v&&h,xX=H||v||$X||d&&!v&&h,NX=$.value.length!==Z.value.levels.length&&$.value.includes(q);return W.Div({children:[W.Div({class:"flex items-center justify-between",children:[W.Div({class:"flex items-center w-80-ns",children:[EX({classNames:"pa2 mr2",colorIndex:_,level:R,totalLevels:Y.value.length}),BX({classNames:"ba bw1 b--light-silver br3 pa2 w-100",placeholder:`Level ${R}`,disabled:NX,text:q,onchange:(i)=>A(i,R)})]}),DZ({hideAdd:OX,hideRemove:xX,onAdd:()=>L(R+1),onRemove:()=>M(R)})]}),W.If({subject:R<Y.value.length-1,isTruthy:W.Div({class:"pa2 ml2 bl bw1 b--light-gray"})})]})}})})}),N({title:"Milestones",child:W.Div({children:W.For({subject:B(()=>SX(U.value)),n:0,nthChild:W.Div({class:"mb1 ph2 pv0 bn bw1 relative ts-white-1",children:[W.Span({class:"lh-copy",children:""}),W.Span({class:"w-30 absolute mt3 right-2 bottom--1dot5 flex items-center z-1",children:[W.Span({class:"w-100 bg-white bn bw1 pa2dot5 di f4 b light-silver mb1 nl1",children:"100"}),W.Span({class:"ph2 bg-white light-silver b mr1",children:"%"})]})]}),map:(q,R)=>W.Div({class:"mb1 ph4 pv4 ba br3 bw1 b--light-gray relative",children:[W.Span({class:"lh-copy flex items-center",children:[c({className:`mr2 ${q.color}`,size:20,iconName:q.icon}),q.label]}),W.Span({class:"w-30 absolute mt3 right-2 bottom--1dot5 flex items-center z-1",children:[W.If({subject:R===3,isTruthy:W.Span({class:"w-100 bg-white bn bw1 br3 pa2dot5 di f4 b light-silver mb1",children:"00"}),isFalsy:KZ({classNames:"w-100 ba bw1 b--light-silver br3 pa2dot5 di f5 b dark-gray",num:q.percent,onchange:(H)=>S(H,R)})}),W.Span({class:"ph2 bg-white light-silver b",children:"%"})]})]})})})})]})}),wZ=(X)=>{let Z=localStorage.getItem(X),$=JSON.parse(Z||"");if(!$)throw`Error fetching habit with id '${X}' from storage`;return $},TZ=(X,Z)=>{localStorage.setItem(X,JSON.stringify(Z))},AZ=()=>{let X=RZ();if(!X.length);let Z,$="";for(let J of X){if(!J.startsWith("id="))continue;let z=+(J.split("id=").pop()||"__");if(!z||isNaN(z))continue;let Y=`h.${z}`;try{Z=wZ(Y)}catch(U){$=U.toString()}}return[Z,$]},MZ=()=>{localStorage.setItem("settings",JSON.stringify(LX))},LZ=()=>{if(!globalThis.localStorage)return LX;let X=localStorage.getItem("settings")||"{}",Z=JSON.parse(X);if(!(typeof Z==="object"&&Z.id==="local-settings"))MZ();return JSON.parse(localStorage.getItem("settings"))},VZ=V(LZ());I(()=>{let X=VZ.value;if(globalThis.localStorage)localStorage.setItem("settings",JSON.stringify(X))});var SZ=k(({isNew:X})=>{let Z=V(!1),$=V(!1),J=V(""),Q=V(BZ()),z=V([]),Y=B(()=>X.value?"New target habit":`Edit '${Q.value.title}'`),U=()=>{if(J.value=_Z(Q.value),J.value)return;let G=Q.value,K=[...z.value],D=`h.${G.id}`,j=[...G.tracker],f=!!(!X.value&&K.length&&K.length!==G.levels.length),A=G.levels.length<K.length;if(f){let w=[];if(!A)K.forEach((L,M)=>{let S=G.levels.indexOf(L);if(S>-1&&S!==M){let R=[];G.tracker.forEach((H,h)=>{if(H===M)R.push(h)}),w.push({indices:R,newValue:S})}});else{let L=-1;for(let M=0;M<K.length;M++)if(K[M]!==G.levels[M]){L=M;break}if(L>=0)K.forEach((M,S)=>{if(S<=L)return;let q=[];G.tracker.forEach((R,H)=>{if(R===S)q.push(H)}),w.push({indices:q,newValue:S-1})})}w.forEach((L)=>{L.indices.forEach((M)=>{j[M]=L.newValue})})}TZ(D,{...Q.value,tracker:j}),_()},_=()=>{location.href=X.value?"/habits/":`/habits/habit/?id=${Q.value.id}`};return jZ({onMount:()=>{if(X.value)return;let[G,K]=AZ();if(K||!G){J.value=K||"Error fetching habit from 'id' given in query params";return}if(Q.value=G,!X.value)z.value=G.levels},body:HZ({classNames:"bg-white ph3",header:W.Div({class:P`${()=>Y.value.length>22?"f2dot66":""}`,children:Y}),content:W.Div([W.If({subject:X,isFalsy:W.Div({class:"",children:[N({classNames:"pb2",title:"Actions",child:W.Div({children:[a({classNames:"bn",isOpen:Z,onTapOutside:()=>Z.value=!1,content:W.Div({class:"pa3 f5",children:[W.Div({class:"mb3 b f4",children:P`Delete '${()=>Q.value.title}'?`}),W.Div({class:"mb4",children:[`
                              All the data and the acheivements associated with this habit will be lost forever
                              with this action, and cannot be reversed.
                              `,W.Br({}),W.Br({}),`
                              Are you sure, you want to DELETE this habit permanently?
                              `]}),W.Div({class:"flex items-center justify-between f6",children:[x({className:"w-25 pv2 ph3 mr1 b",children:"No",onTap:()=>Z.value=!1}),x({className:"pv2 ph3 ml2 b red",children:"Yes, delete permanently",onTap:()=>{let G=`h.${Q.value.id}`;localStorage.removeItem(G),Z.value=!1,location.href="/habits/"}})]})]})}),GX({classNames:"db mb3 f6 red",children:"Delete this habit permanently along with its data",onClick:()=>Z.value=!0}),a({classNames:"bn",isOpen:$,onTapOutside:()=>$.value=!1,content:W.Div({class:"pa3 f5",children:[W.Div({class:"mb3 b f4",children:P`Stop '${()=>Q.value.title}'?`}),W.Div({class:"mb4",children:[`
                              This action is not reversible. You will not be able to resume it again.`,W.Br({}),W.Br({}),`
                              Are you sure, you want to STOP this habit permanently?
                              `]}),W.Div({class:"flex items-center justify-between f6",children:[x({className:"w-100 pv2 ph3 mr2",children:"No, go back",onTap:()=>$.value=!1}),x({className:"w-100 pv2 ph3 ml2 b",children:"Yes, stop this",onTap:()=>{Q.value={...Q.value,isStopped:!0},U(),$.value=!1}})]})]})}),GX({classNames:"db mb3 f6 gray",children:"Stop this habit permanently and keep it for review in future",onClick:()=>$.value=!0})]})})]})}),kZ({habit:Q,initialLevels:z,onChange:(G)=>Q.value=G})]),bottombar:W.Div({class:"bg-white w-100 pv3",children:[W.If({subject:J,isTruthy:W.Div({class:"red mb3",children:J})}),W.Div({class:"flex items-center justify-stretch",children:[x({className:"w4dot50 w4dot25-ns pa3 flex items-center",children:[c({iconName:"arrow_back"}),W.Span({class:"ml1",children:"Go Back"})],onTap:_}),x({className:"w-100 pa3 ml3 b",children:B(()=>X.value?"Save":"Update"),onTap:U})]})]})})})}),N=k(({classNames:X,title:Z,child:$})=>{return W.Div({class:P`mt3 mb4 ${X}`,children:[W.Div({class:"mb2 dark-gray f4 b",children:Z}),W.Div($)]})}),IZ=k(({classNames:X,iconSize:Z,selectedOptionIndex:$,onChange:J})=>{let Q=V(!1),z=B(()=>UX[$.value]),Y=(U)=>{J(U),Q.value=!1};return W.Div({class:X,children:[_X({classNames:"pointer",descending:B(()=>z.value.decending),iconName:B(()=>z.value.icon),size:B(()=>Z?.value??20),onClick:()=>Q.value=!0}),a({classNames:"f5 normal ba bw0 outline-0",isOpen:Q,onTapOutside:()=>Q.value=!1,content:W.Div({children:[W.Div({class:"f5 b tc pv3",children:"Sort habit cards by"}),W.Div({class:"f5 mb1",children:W.For({subject:UX,map:(U,_)=>{let F=P`pointer flex items-center pv3 pl2 pr3 bt b--moon-gray ${()=>U.label===z.value.label?"bg-near-white black":"gray"}`;return W.Div({class:F,onclick:T(()=>Y(_)),children:[_X({classNames:"ml1 mr2",descending:U.decending,iconName:U.icon,size:20}),W.Span(U.label)]})}})})]})})]})}),_X=k(({classNames:X,descending:Z,iconName:$,size:J,onClick:Q})=>{return W.Span({class:P`flex items-center ${()=>Q?"pointer":""} ${X}`,onclick:T(Q),children:[c({className:"silver",size:B(()=>4*J.value/5),iconName:B(()=>Z.value?"arrow_upward":"arrow_downward")}),c({className:"",size:J,iconName:$})]})}),EZ=SZ({isNew:!0}),OZ=()=>{E.start("mount"),PX.resetIdCounter(),EZ(),E.start("run")};OZ();
