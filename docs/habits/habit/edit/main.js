var d=(X)=>{let $=Object.entries(X).sort((Q,J)=>Q[0].localeCompare(J[0]));return $.forEach(([Q,J],W)=>{if(J&&typeof J==="object"&&!Array.isArray(J))$[W]=[Q,d(J)]}),Object.fromEntries($)},i=(X)=>{if(typeof X!=="object"||X===null||Array.isArray(X))return!1;return Object.prototype.toString.call(X)==="[object Object]"},p=(X)=>{if(Array.isArray(X)){let $=[...X],Q=[];return $.forEach((J)=>{Q.push(p(J))}),Q}if(i(X)){let $={...X},Q={};return Object.keys($).forEach((J)=>{Q[J]=p($[J])}),Object.freeze(Q)}return X},y=(X)=>{if(Array.isArray(X)){let Q=[...X],J=[];return Q.forEach((W)=>{J.push(y(W))}),J}if(i(X)){let Q={...X},J={};return Object.keys(Q).forEach((W)=>{J[W]=y(Q[W])}),J}return X},zX=(X,$="index")=>X.map((Q,J)=>({[$]:J,value:Q})),tX=(X,$)=>{let Q=d(X),J=d($),W=Object.keys(Q),Y=Object.keys(J);if(W.length!==Y.length)return!1;for(let z of W)if(!Y.includes(z)||!l(Q[z],J[z]))return!1;return!0},eX=(X,$)=>{if(X.length!==$.length)return!1;if(X.length===0)return!0;for(let Q=0;Q<X.length;Q++)if(!l(X[Q],$[Q]))return!1;return!0},l=(X,$)=>{if(typeof X!==typeof $)return!1;if(Array.isArray(X))return eX(X,$);if(X===null||$===null)return X===$;if(typeof X==="object"&&!(X instanceof Set))return tX(X,$);if(typeof X==="bigint"||typeof X==="number"||typeof X==="string"||typeof X==="boolean")return X===$;return X===$},X0=(X,$,Q)=>{let W=zX(y(X),"index");return zX(y($),"index").map((z)=>{let U="add",q=-1,G=z.value;return W.some((F,O)=>{if(U=l(F.value,z.value)?F.index===z.index?"idle":"shuffle":Q&&F.value[Q]!==void 0&&F.value[Q]===z.value[Q]?"update":"add",U!=="add")return q=F.index,W.splice(O,1),!0;return!1}),{type:U,oldIndex:q,value:G}})},L=(X)=>["source-signal","derived-signal"].includes(X?.type),KX=(X,$)=>X?.type==="non-signal"&&(!$||!$.length||$.some((Q)=>typeof X?.value===Q)),a=(X)=>L(X)||KX(X),fX=(X)=>KX(X,["string"]),wX=(X)=>X?.type==="non-signal"&&Array.isArray(X?.value)&&(X?.value).every(($)=>typeof $==="string"),g=(X)=>a(X)?X.value:X,u=null,T=(X)=>{let $=p(X),Q=new Set;return{type:"source-signal",get value(){if(u)Q.add(u);return y($)},set value(J){if(J===$)return;$=p(J),Q.forEach((W)=>W&&W())}}},x=(X)=>{u=X,X(),u=null},R=(X)=>{let $,Q=T($);return x(()=>{$=X($),Q.value=$}),{type:"derived-signal",get prevValue(){return $},get value(){return Q.value}}},s=(X)=>{if(!i(X.value))throw new Error("Thee argument should be a plain object or a signal of plain object");return{prop:($)=>R(()=>X.value[$]),get props(){return Object.keys(X.value).reduce((Q,J)=>{let W=J;return Q[W]=this.prop(W),Q},{})}}},B=(X,...$)=>R(()=>{return X.reduce((Q,J,W)=>{let Y,z=$[W];if(typeof z==="function")Y=z()??"";else if(a(z))Y=z.value??"";else Y=z??"";return`${Q}${J}${Y.toString()}`},"")}),OX=["onmount","onunmount"],VX=["onerror","onload","onresize","onblur","onchange","oncontextmenu","onfocus","oninput","oninvalid","onreset","onselect","onsubmit","onkeydown","onkeypress","onkeyup","onclick","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onscroll","onabort","oncanplay","oncanplaythrough","ondurationchange","onemptied","onended","onerror","onloadeddata","onloadedmetadata","onloadstart","onpause","onplay","onplaying","onprogress","onratechange","onseeked","onseeking","onstalled","onsuspend","ontimeupdate","onvolumechange","onwaiting"],$0=[...VX,...OX],Q0=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"],h,J0=(X)=>{if(!h)h=document.createElement("textarea");return h.innerHTML=X,h.value},W0=()=>{let X=0;return{getNewId:()=>++X,resetIdCounter:()=>X=0}},kX=W0(),A={currentIs:(X)=>window._currentAppPhase===X,start:(X)=>{window._currentAppPhase=X,console.log(`Current phase is ${X}`)}},m=(X)=>Array.isArray(X),r=(X)=>!isNaN(X?.elementId)&&X?.elementId>0,C=(X)=>typeof X==="string"||typeof X==="function"&&X.isElementGetter,t=(X)=>L(X)&&C(X.value),Z0=(X)=>C(X)||t(X),DX=(X)=>{return L(X)&&(C(X.value)||m(X.value)&&X.value.every(($)=>C($)))},MX=(X)=>{return!L(X)&&(fX(X)||wX(X)||C(X)||m(X)&&X.every(($)=>Z0($)))},e=(X)=>{return DX(X)||MX(X)},YX=!1,z0={},N={},Y0=globalThis.MutationObserver,U0=new Y0((X)=>{X.forEach(($)=>{if($.type==="childList")$.addedNodes.forEach((Q)=>{if(r(Q)){let J=Q,W=J.elementId;if(N[W])delete N[W];else z0[W]=J.tagName}}),$.removedNodes.forEach((Q)=>{if(r(Q)){let J=Q,W=J.elementId,Y=J.unmountListener;if(Y)N[W]={element:J,unmountListener:Y}}})}),Object.entries(N).forEach(([$,Q])=>{let{element:J,unmountListener:W}=Q;AX(J,W)})}),AX=(X,$)=>{if(!r(X))return;let Q=X.children;for(let J=0;J<Q.length;J++){let W=Q[J];AX(W,W.unmountListener)}if($&&$(X),N[X.elementId])delete N[X.elementId]},q0=()=>{if(!YX&&!A.currentIs("build"))U0.observe(document.body,{childList:!0,subtree:!0}),YX=!0},TX=(X,$)=>$0.includes(X)&&$===void 0,EX=(X,$)=>VX.includes(X)&&typeof $==="function",HX=(X,$)=>OX.includes(X)&&typeof $==="function",G0=(X,$)=>TX(X,$)||EX(X,$)||HX(X,$),B0=(X,$)=>{Object.entries($).forEach(([Q,J])=>{if(TX(Q,J));else if(EX(Q,J)){let W=Q.slice(2);X.addEventListener(W,(Y)=>{if(W==="keypress")Y.preventDefault();J(Y)})}else if(HX(Q,J)){if(Q==="onmount"&&!A.currentIs("build")){let W=J;setTimeout(()=>W(X),0)}if(Q==="onunmount")q0(),X.unmountListener=J}else console.error(`Invalid event key: ${Q} for element with tagName: ${X.tagName}`)})},UX=(X,$,Q)=>{let J=(a(Q)?Q.value:Q)??"";if(typeof J==="boolean")if(J)X.setAttribute($,"");else X.removeAttribute($);else if($==="value")X.value=J;else if(J)X.setAttribute($,J)},R0=(X,$)=>{let Q={};Object.entries($).forEach((J)=>{let[W,Y]=J;if(L(Y))Q[W]=Y;UX(X,W,Y)}),x(()=>{Object.entries(Q).forEach((J)=>{let[W,Y]=J,z=Y.value;if(!A.currentIs("run"))return;UX(X,W,z)})})},c=(X)=>{if(t(X)){let $=X.value;return c($)}if(typeof X==="string")return document.createTextNode(J0(X));if(C(X)){let $=X();if(!r($))throw new Error(`Invalid MHtml element getter child. Type: ${typeof X}`);return $}throw new Error(`Invalid child. Type of child: ${typeof X}`)},F0=(X,$)=>{if(!$)return;if(DX($))x(()=>{let J=$.value,W=m(J)?J:[J];W.forEach((z,U)=>{let q=X.childNodes[U],G=c(z);if(q&&G)X.replaceChild(G,q);else if(G)X.appendChild(G);else console.error(`No child found for node with tagName: ${X.tagName}`)});let Y=W.length;while(Y<X.childNodes.length){let z=X.childNodes[Y];if(z)X.removeChild(z)}});if(MX($)){let Q=fX($)?[$.value]:wX($)?$.value:m($)?$:[$],J=[];if(Q.forEach((W,Y)=>{if(t(W))J.push({index:Y,childSignal:W});let z=c(W),U=X.childNodes[Y];if(U&&z)X.replaceChild(z,U);else if(!U&&z)X.appendChild(z);else console.error(`No child found for node with tagName: ${X.tagName}`)}),J.length)J.forEach(({index:W,childSignal:Y})=>{x(()=>{if(!Y.value)return;if(!A.currentIs("run"))return;let z=c(Y.value),U=X.childNodes[W];if(U&&z)X.replaceChild(z,U);else if(!U&&z)X.appendChild(z);else console.error(`No child found for node with tagName: ${X.tagName}`)})})}},_0=(X,$)=>{let Q=void 0,J={},W={};return Object.entries(X).forEach(([Y,z])=>{if(Y==="children")if(e(z))Q=z;else throw new Error(`Invalid children prop for node with tagName: ${$}

 ${JSON.stringify(z)}`);else if(G0(Y,z))J[Y]=z;else W[Y]=z}),{children:Q,eventProps:J,attributeProps:W}},P0=(X,$)=>{let Q=()=>{let J=kX.getNewId(),W=A.currentIs("mount")?document.querySelector(`[data-elem-id="${J}"]`):document.createElement(X);W.elementId=J,W.unmountListener=void 0;let Y=e($)?{children:$}:$;if(!A.currentIs("run"))Y["data-elem-id"]=W.elementId.toString();let z=_0(Y,W.tagName);if(B0(W,z.eventProps),R0(W,z.attributeProps),F0(W,z.children),!A.currentIs("build"))W.removeAttribute("data-elem-id");return W};return Q.isElementGetter=!0,Q},qX=(X,$,Q)=>{let J=T($),W=T(X),Y=Q(R(()=>W.value),R(()=>J.value)),z,U,q=!1;if(Y?.isElementGetter)z=()=>{if(q&&U)return U;return U=Y(),q=!0,U},z.isElementGetter=!0;else if(typeof Y==="string")z=Y;else throw`One of the child, ${Y} passed in ForElement is invalid.`;return{indexSignal:J,itemSignal:W,mappedChild:z}},GX=(X,$,Q)=>{if($!==void 0&&$>=0&&Q){let J=$>X.length?X.length:$;X.splice(J,0,Q)}return X},j0=({subject:X,itemKey:$,map:Q,n:J,nthChild:W})=>{if(W&&J===void 0||J!==void 0&&J>-1&&!W)throw new Error("Either both 'n' and 'nthChild' be passed or none of them.");let Y=R(()=>{let K=g(X);return Array.isArray(K)?K:[]});if(!$)return R(()=>GX(Y.value.map(Q),J,W));let z=W;if(W&&typeof W!=="string"){let K=W(),j=()=>K;j.isElementGetter=!0,z=j}let U=Y.value;if(U.length&&typeof U[0]!=="object")throw new Error("for mutable map, item in the list must be an object");let q=null,G=R((K)=>{return q=K||q,Y.value}),F=R((K)=>{if(!K||!q)return G.value.map((V,k)=>qX(V,k,Q));return X0(q,G.value,$).map((w,V)=>{let k=(K||[])[w.oldIndex];if(console.assert(w.type==="add"&&w.oldIndex===-1&&!k||w.oldIndex>-1&&!!k,"In case of mutation type 'add' oldIndex should be '-1', or else oldIndex should always be a non-negative integer."),k){if(w.type==="shuffle")k.indexSignal.value=V;if(w.type==="update")k.indexSignal.value=V,k.itemSignal.value={...w.value};return k}return qX(w.value,V,Q)})});return R(()=>GX(F.value.map((K)=>K.mappedChild),J,z))},K0=({subject:X,isTruthy:$,isFalsy:Q})=>{let J=Z.Span({style:"display: none;"}),W=()=>(g(X)?$:Q)||J;return L(X)?R(W):W()},f0=({subject:X,caseMatcher:$,defaultCase:Q,cases:J})=>{let W=()=>{let Y=g(X),z=void 0;for(let[U,q]of Object.entries(J))if($&&$(X,U)||Y===U){z=q;break}return z||Q||Z.Span({style:"display: none;"})};return L(X)?R(W):W()},w0=Q0.reduce((X,$)=>{let Q=$.split("").map((W,Y)=>!Y?W.toUpperCase():W).join(""),J=(W)=>P0($,W);return X[Q]=J,X},{}),O0={For:j0,If:K0,Switch:f0},Z={...w0,...O0},f=(X)=>($)=>{for(let J of Object.keys($))if($[J]===void 0)delete $[J];let Q=Object.entries($).reduce((J,W)=>{let[Y,z]=W,U=typeof z==="string",q=Array.isArray(z)&&z.every((F)=>typeof F==="string"),G=L(z)||typeof z==="function"?z:U||q?{type:"non-signal",get value(){return g(z)}}:e(z)?z:{type:"non-signal",get value(){return g(z)}};return J[Y]=G,J},{});return X(Q)};var BX=86400000,V0=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],k0=["January","February","March","April","May","June","July","August","September","October","November","December"],D0=(X,$)=>V0[X].substring(0,$),M0=(X,$)=>k0[X].substring(0,$),XX=(X)=>{return new Date(X.getFullYear(),X.getMonth(),X.getDate())},I=(X)=>XX(X).getTime(),A0=(X,$)=>I(X)===I($),T0=(X,$)=>new Date(X.getFullYear(),X.getMonth(),X.getDate()+$),E0=(X)=>{let $=new Date;return Array(X).fill(0).map((Q,J)=>new Date($.getFullYear(),$.getMonth()-J,1)).reverse()},H0=(X,$)=>{let Q=I(X),J=I($);if(Q===J)return[XX(new Date(Q))];let W=Q<J?Q:J,z=((Q<J?J:Q)-W)/BX;return Array(z+1).fill(0).map((U,q)=>new Date(W+q*BX))},LX=["#e87b52","#F5E06F","#A3BA64","#7095C9","#A59EE3","#D89DBF"],L0=[1,1,1,1,1,1,1],x0=[{name:"Not Applicable",code:-1},{name:"Paused",code:-2},{name:"Stopped",code:-3}],S0=["Not done","Done"],N0=[70,60,45],RX={id:"analytics",lastInteraction:new Date().getTime()},b={id:"local-settings",habitsPage:{tabIndex:0,sortOptionIndex:0},editPage:{showHints:!0,showFullCustomisation:!1}},FX=[{icon:"calendar_month",decending:!0,label:"Date created (Newest first)"},{icon:"calendar_month",decending:!1,label:"Date created (Oldest first)"},{icon:"task_alt",decending:!0,label:"Completion (Highest first)"},{icon:"task_alt",decending:!1,label:"Completion (Lowest first)"}],C0={href:"/",HABITS:{href:"/habits/",NEW:{href:"/habits/new/"},HABIT:{href:"/habits/habit/",EDIT:{href:"/habits/habit/edit/"}}},SETTINGS:{href:"/settings/",PRIVACY_POLICY:{href:"/settings/privacy-policy/"}}},I0=(X)=>location.href=X,y0=()=>location.href=C0.HABITS.NEW.href,g0=(X)=>{if(!A.currentIs("run"))return"";let $=window.location.search;return new URLSearchParams($).get(X)||""},b0=1.6181,v0=()=>{let $=+g0("id");if(isNaN($)||!$)return;try{return cX($)}catch(Q){return}},h0=(X)=>x0.find(($)=>$.code===X),xX=(X,$)=>{return X<0?h0(-1):{name:$[X],code:X}},c0=(X)=>({level:xX(-1,[]),date:X}),p0=(X,$,Q)=>({level:xX(X,$),date:Q}),u0=(X,$)=>X.find((Q)=>I(Q.date)===I($)),$X=(X)=>{let $=XX(new Date(X.id));return{...X,startDate:$,levels:X.levels.map((Q,J)=>({name:Q,code:J})),tracker:X.tracker.map((Q,J)=>p0(Q,X.levels,T0($,J)))}},SX=(X)=>{return{...X,levels:X.levels.map(($)=>$.name),tracker:X.tracker.map(($,Q)=>$.level.code)}},m0=()=>{let $={id:new Date().getTime(),title:"",frequency:L0,colorIndex:0,levels:S0,tracker:[],milestones:N0,pauses:[],isStopped:!1};return $X($)},NX=(X)=>[{label:"Successful",percent:X[0],icon:"verified_user",color:"green"},{label:"Little more to go",percent:X[1],icon:"done_all",color:"light-blue"},{label:"Going good",percent:X[2],icon:"check",color:"blue"},{label:"Unacceptable",percent:0,icon:"close",color:"red"}],n=(X,$)=>{let Q=NX(X),J=Q[0];for(let W=0;W<Q.length;W++)if(J=Q[W],J.percent<$)break;return J},r0=(X,$)=>{if(!X.title)return"Title should not be empty";if($&&U1(X.title))return"A habit with same name already exists";if(X.frequency.every((J)=>!J))return"Select at least one day in a week";if(!X.levels.every((J)=>!!J.name))return"One of the levels is empty";if(X.levels.some((J,W)=>{for(let Y=W+1;Y<X.levels.length;Y++)if(X.levels[Y].name===J.name)return!0;return!1}))return"Multiple levels have same name";if(!X.milestones.every((J)=>J<=100&&J>=0))return"The milestones should be between 0 and 100 percents";if(!X.milestones.every((J,W,Y)=>W===0?!0:Y[W-1]>J))return"Milestones should be in order (from high to low)";return""},s0=(X,$,Q)=>{let J=CX(X.tracker,$,Q),W=X.levels.length-1,Y=0,z=0,U=0,q=0,G=0,F=0;return J.forEach((O,K)=>{if(Y++,z+=O.level.code>0?1:0,U+=O.level.code>0?O.level.code:0,K===J.length-1)return;let w=O.level.code<1;F=w?F+1:0;let k=100*((O.level.code>0?O.level.code:0)/(X.levels.length-1));q=Math.round(k)>50?q+1:0,G=w?0:G+1}),{title:X.title,aceStreak:q,followStreak:G,missed:F,percent:Math.ceil(100*(U/(Y*W))),totalDays:Y,workingDays:z}},o0=(X,$,Q)=>{let J=!!X.length;if(!J)return{hideAddButton:!1,hideRemoveButton:$.length<3};let W=$[Q],Y=!!(J&&X.find((K)=>K.name===W.name)),z=X.length!==$.length,U=$.length<X.length,q=$.length>X.length,G=!z&&X.length&&X.some((K,j)=>K.name!==$[j].name);return{hideAddButton:U||G||Y&&U,hideRemoveButton:U||G||Y&&q}},d0=(X,$,Q)=>{let J=!!X.length,W=$[Q],Y=!!(J&&X.find((U)=>U.name===W.name)),z=X.length!==$.length;return Y&&z},n0=(X,$,Q,J=!1)=>{let W=LX[Q],z=Math.trunc(Math.pow(X/($-1),b0)*255).toString(16),U=z.length===1?`0${z}`:z,q=X<0||U==="0"?"transparent":`${W}${U}`,G=J?X/($-1)>0.5?"white":"black":X<0?"lightgray":"transparent";return{backgroundColor:q,fontColor:G}},i0=(X,$)=>{let Q=[];for(let J of $)if(!X.some((Y)=>{if(A0(Y.date,J))return Q.push(Y),!0;return!1}))Q.push(c0(J));return Q},CX=(X,$,Q)=>{let J=H0($,Q);return i0(X,J)},l0=(X,$,Q)=>{if(!X.length||X.length===$.length)return Q;let J=[...Q],W=[];return X.forEach((Y)=>{let z=$.find((F)=>F.name===Y.name);if(!z)return;if(z.code===Y.code)return;let G=[];Q.forEach((F,O)=>{if(F.level.code===Y.code)G.push(O)}),W.push({indices:G,newLevel:z})}),W.forEach((Y)=>{Y.indices.forEach((z)=>{J[z]={...J[z],level:Y.newLevel}})}),J},a0=(X)=>X.startsWith("h."),QX=(X)=>`h.${X}`,IX=(X)=>{if(!a0(X))return;let $=localStorage.getItem(X),Q=JX($,"title");if(!Q)return;return Q},t0=()=>{if(!A.currentIs("run"))return[];let X=[];for(let $ in localStorage){let Q=IX($);if(!Q)continue;X.push(Q)}return X},yX=(X)=>{let $=QX(X.id);localStorage.setItem($,JSON.stringify(X))},e0=(X)=>{let $=QX(X);localStorage.removeItem($)},gX="settings",X1="id",$1="local-settings",bX=(X)=>{localStorage.setItem(gX,JSON.stringify(X))},Q1=()=>{if(!A.currentIs("run"))return b;let X=()=>{let J=localStorage.getItem(gX);return JX(J,X1,$1)};if(!X())bX(b);let Q=X();if(!Q)throw"Error fetching settings";return J1(Q),X()},J1=(X)=>{if(!X.editPage)console.log("settings.editPage is missing"),console.log("adding ",{...X,editPage:b.editPage}),bX({...X,editPage:b.editPage})},vX="analytics",W1="id",Z1="analytics",hX=(X)=>{localStorage.setItem(vX,JSON.stringify(X))},z1=()=>{if(!A.currentIs("run"))return console.log("return initial analytics"),RX;let X=()=>{let J=localStorage.getItem(vX);return JX(J,W1,Z1)};if(!X())console.log("NO ANALYTICS FOUND"),hX(RX);let Q=X();if(!Q)throw"Error fetching analytics";return Q},Y1=(X)=>{let $=z1();hX({...$,lastInteraction:X.getTime()})},cX=(X)=>{let $=QX(X),Q=IX($);if(!Q)throw`Error fetching habit with id '${X}' from storage`;return $X(Q)},U1=(X)=>{let Q=t0().find((J)=>J.title.trim()===X.trim());return Q?$X(Q):void 0},q1=(X)=>{let $=SX(X);yX($)},G1=(X)=>{let $=cX(X),J={...SX($),isStopped:!0};yX(J)},B1=(X)=>e0(X),R1=()=>{return Q1().editPage},F1=()=>{if(window.navigator?.vibrate)window.navigator.vibrate(3)},JX=(X,$,Q)=>{let J=JSON.parse(X||"{}"),W=J&&typeof J==="object",Y=J[$];if(!W||!(Q?Y===Q:!!Y))return;return J},D=(X)=>{return(...$)=>{return F1(),Y1(new Date),X&&X(...$)}},_1=f(({classNames:X,hideRemove:$,hideAdd:Q,onRemove:J,onAdd:W})=>{return Z.Span({class:B`br3 pb1 f4 bw1 b--light-silver dark-gray ${()=>$?.value&&Q?.value?"bn":"ba"} ${X}`,children:[Z.If({subject:$,isFalsy:Z.Span({class:B`pointer ph2 pb1 bw1 b--light-silver ${()=>Q?.value?"":"br"}`,onclick:D(J),children:"-"})}),Z.If({subject:Q,isFalsy:Z.Span({class:"pointer ph2 pb1",onclick:D(W),children:"+"})})]})}),H=f(({className:X,onTap:$,children:Q})=>Z.Button({class:B`pointer noselect br-pill ba bw1 b--light-silver b--hover-black bg-white black ${X}`,onclick:D(()=>$()),children:Q})),E=f(({className:X,size:$,onClick:Q,iconName:J,title:W})=>Z.Span({class:B`material-symbols-outlined ${()=>Q?"pointer":""} ${X}`,style:B`font-size: ${()=>$?.value||"16"}px`,onclick:D(Q),children:J,title:W})),pX=f(({classNames:X,dotClassNames:$,colorIndex:Q,level:J,totalLevels:W,showText:Y,textContent:z,icon:U,iconSize:q,isRectangular:G,onClick:F})=>{let O=R(()=>G?.value?"br0":"br-100"),K=R(()=>J.value<0?"bg-transparent":"bg-light-gray"),{backgroundColor:j,fontColor:w}=s(R(()=>n0(J.value,W.value,Q.value,Y?.value))).props,V=R(()=>G?.value?"br0":"br-100"),k=R(()=>z?.value||"·"),v=()=>{if(F&&J.value>=0)F()};return Z.Span({class:B`pointer relative ${O} ${K} ${X}`,onclick:D(v),children:[Z.Span({class:B`flex items-center justify-around absolute absolute--fill ${V} ${$}`,style:B`
            background-color: ${j};
            color: ${w};
          `,children:Z.If({subject:U,isTruthy:E({iconName:U,size:q}),isFalsy:Z.Span(k)})})]})}),_X=f(({classNames:X,href:$,target:Q,onClick:J,children:W})=>{return Z.A({class:B`noselect ${()=>!$&&!J?"":"pointer underline"} ${X}`,href:$,target:Q,onclick:D(J),children:W})}),o=f(({classNames:X,isOpen:$,content:Q,onTapOutside:J})=>{return Z.Dialog({onmount:(W)=>setTimeout(()=>x(()=>{if($.value)W.showModal();else W.close()})),onclick:D(J),class:B`pa0 br3 ${X}`,children:[Z.Div({onclick:(W)=>W.stopPropagation(),children:Q})]})}),P1=f(({classNames:X,placeholder:$,num:Q,onchange:J})=>{let W=(Y)=>{let z=Y.target.value,U=Number.parseFloat(Number.parseFloat(z||"0").toFixed(2));J(U)};return Z.Input({class:X,type:"number",placeholder:$,value:B`${()=>Q.value??""}`,onchange:W})}),j1=f(({classNames:X,body:$,onMount:Q})=>{return Z.Html({lang:"en",children:[Z.Head({children:[Z.Title("Habits (by Cyfer)"),Z.Meta({charset:"UTF-8"}),Z.Meta({"http-equiv":"X-UA-Compatible",content:"IE=edge"}),Z.Meta({name:"viewport",content:"width=device-width, initial-scale=1.0"}),Z.Link({rel:"stylesheet",href:"/assets/styles.css"}),Z.Link({rel:"manifest",href:"/manifest.json"})]}),Z.Body({class:X,onmount:Q,children:[Z.Script({src:"main.js",defer:"true"}),$]})]})}),E1=f(({progress:X,classNames:$})=>{let Q=B`width: ${()=>X.value<0?0:X.value>100?100:X.value}%;`;return Z.Div({class:B`br-pill bg-moon-gray ${$}`,children:Z.Div({class:"br-pill bg-app-theme-color pa1",style:Q})})}),uX=f(({classNames:X,header:$,content:Q,bottombar:J})=>{return Z.Div({class:"flex-ns justify-center-ns",children:Z.Div({class:B`w6-ns ${X}`,children:[Z.If({subject:$,isTruthy:Z.Div({class:"overflow-break-word sticky top-0 left-0 right-0 bg-inherit z-999 f2dot33 b pv3 mt2",children:$})}),Q,Z.Div({class:"pv6 mt5"}),Z.If({subject:J,isTruthy:Z.Div({class:"sticky bottom-0 left-0 right-0 z-9999",children:J})})]})})}),H1=f(({classNames:X,tabItemClassNames:$,selectedTabClassNames:Q,tabs:J,selectedTabIndex:W,onTabChange:Y})=>{return Z.Div({class:B`bg-white br3 ${X}`,children:Z.Div({class:"flex items-center justify-between pa1",children:Z.For({subject:J,map:(z,U)=>Z.Span({class:B`w-100 br3 pv3 ph2 flex justify-center noselect br-pill ba bw1 bg-inherit ${()=>U===W.value?`b--light-silver b black ${Q?.value}`:"pointer b--transparent b--hover-black silver pointer"} ${$}`,onclick:D(()=>Y(U)),children:z})})})})}),PX=f(({classNames:X,placeholder:$,disabled:Q,text:J,onmount:W,onchange:Y,onkeydown:z,onfocus:U,onblur:q})=>{let G,F=(j)=>{if(G=j,W)W(j)},O=(j)=>{let w=j.target.value;if(Y)Y(w)},K=(j)=>{let w=j.key.length===1?G.value+j.key:j.key==="Backspace"?G.value.slice(0,-1):G.value,V={key:j.key,text:w};if(z)z(V)};return Z.Input({onmount:F,class:B`${X}`,type:"text",placeholder:$,disabled:Q,value:J,onchange:O,onkeydown:K,onfocus:U,onblur:q})}),L1=f(({classNames:X,isOn:$,onToggle:Q})=>{return Z.Div({class:B`flex items-center pointer noselect br-pill ba bw1dot5 b--mid-gray b--hover-black bg-white pa05 black ${X}`,onclick:D(Q),children:[Z.Div({class:B`br-100 ba bw2 b--hover-black pa1 ${()=>$?.value?"b--transparent":"b--moon-gray"}`}),Z.Div({class:"pa05"}),Z.Div({class:B`br-100 ba bw2 b--hover-black pa1 ${()=>$?.value?"b--mid-gray":"b--transparent"}`})]})}),x1=f(({classNames:X})=>{return Z.Div({class:B`w-100 flex justify-end ${X}`,children:H({className:"pa3 mb3 shadow-4 b flex items-center",children:[E({className:"nl1 mr1",size:22,iconName:"add"}),"Add habit"],onTap:y0})})}),K1=f(({classNames:X})=>{return H({className:B`pa3 flex items-center ${X}`,children:[E({iconName:"arrow_back"}),Z.Span({class:"ml1",children:"Go Back"})],onTap:()=>history.back()})}),f1=f(({classNames:X,habit:$,date:Q,colorIndex:J,totalLevels:W})=>{let Y=R(()=>{let z=Q.value.getFullYear(),U=Q.value.getMonth(),q=new Date(z,U,1),G=new Date(z,U+1,0);return CX($.value.tracker,q,G)});return Z.Div({class:B`flex items-center ${X}`,children:[Z.Div({class:"f8 b w2 light-silver",children:R(()=>M0(Q.value.getMonth(),3))}),Z.Div({class:"w-100 flex items-center justify-between",children:Z.For({subject:Y,map:(z)=>pX({classNames:"pa1",colorIndex:J,level:z.level.code,totalLevels:W})})})]})}),S1=f(({classNames:X,habit:$,months:Q,onClick:J})=>{let{milestones:W,title:Y,colorIndex:z,levels:U}=s(R(()=>$.value)).props,q=R(()=>{let K=new Date,j=K.getFullYear(),w=K.getMonth(),V=new Date(j,w-(Q.value+1),1),k=new Date(j,w+1,0);return s0($.value,V,k).percent}),G=R(()=>n(W.value,q.value).icon),F=R(()=>n(W.value,q.value).color),O=R(()=>E0(Q.value));return Z.Div({class:B`pointer bg-white ${X}`,onclick:D(J),children:[Z.Div({class:"flex items-center justify-between nt1 mb2",children:[Z.Div({class:"f4 dark-gray b",children:Y}),Z.Div({class:"f6 silver b flex items-center",children:[E({className:B`mr1 ${F}`,iconName:G}),B`${q}%`]})]}),Z.Div({class:"mt3 mb1",children:Z.For({subject:O,map:(K)=>f1({classNames:"mb1",habit:$,date:K,colorIndex:z,totalLevels:U.value.length})})})]})}),w1=f(({classNames:X,editableHabit:$,editedHabit:Q,hideDescriptions:J,showFullCustomisations:W,onChange:Y})=>{x(()=>console.log(J?.value));let z=T(!1),U=R(()=>{let P=z.value;return W?.value||P}),{title:q,frequency:G,levels:F,milestones:O,colorIndex:K}=s(Q).props,j=R(()=>G.value.every((P)=>!!P)),w="bg-mid-gray white",V="bg-near-white light-silver",k=(P)=>{Y({...Q.value,title:P})},v=(P)=>{Y({...Q.value,colorIndex:P})},WX=(P)=>{if(P<-1||P>6)throw"Invalid day index";if(P===-1){Y({...Q.value,frequency:[1,1,1,1,1,1,1]});return}let _=j.value?G.value.map((M)=>0):G.value;_[P]=j.value?1:_[P]?0:1,Y({...Q.value,frequency:_})},rX=(P,_)=>{let M=F.value;M[_]={...M[_],name:P},Y({...Q.value,levels:M})},sX=(P)=>{let _=F.value;_.splice(P,0,{name:"",code:P}),Y({...Q.value,levels:_})},oX=(P)=>{let _=F.value;if(_.length<3)return;_.splice(P,1),Y({...Q.value,levels:_})},dX=(P,_)=>{if(_<0||_>2)throw"Incorrect index of milestone passed. Milestone values should not be more than 3.";let M=[...Q.value.milestones];M[_]=P,Y({...Q.value,milestones:M})};return Z.Div({class:X,children:[S({classNames:"pb1",title:"Schedule",children:Z.Div({class:"mb3 f6 flex items-center justify-between justify-start-ns",children:Z.For({subject:Array(7).fill(0),n:0,nthChild:Z.Span({class:B`pointer flex items-center justify-center br-pill h2 ph2 mr3-ns ${()=>j.value?w:V}`,children:"Daily",onclick:D(()=>WX(-1))}),map:(P,_)=>{let M=R(()=>G.value[_]&&!j.value?w:V);return Z.Span({class:B`pointer flex items-center justify-center br-100 h2 w2 mr3-ns ${M}`,children:D0(_,1),onclick:D(()=>WX(_))})}})})}),S({classNames:"pb2",title:"Title",children:PX({classNames:"ba bw1 b--light-silver br3 pa2 w-100",placeholder:'for example, "wake up at 5am"',text:q,onchange:k})}),Z.If({subject:U,isTruthy:Z.Div([S({classNames:"pb1",title:"Color",children:Z.Div({class:"mb1 flex items-center",children:Z.For({subject:LX,map:(P,_)=>{let M=R(()=>_===K.value?"#999":"#f4f4f4");return Z.Span({class:"pointer mb2 mr3 pa1 br-100 bw2 ba flex",style:B`border-color: ${M}`,onclick:D(()=>v(_)),children:Z.Span({class:B`pa2 br-100`,style:`background-color: ${P}`})})}})})}),S({classNames:"pb3",title:"Levels",hideDescription:J,description:`
                  A habit can have more than 2 levels. Like the habit 'Drink 2 litres water'
                  should have three levels - '0 litre', '1 litre' and '2 litres' respectively.
                  You can add or remove level by clicking on + or - buttons. Click on textbox
                  for editing the level name.
                `,children:Z.For({subject:F,map:(P,_)=>{let M=$?.value?.levels||[],ZX=F.value,{hideAddButton:nX,hideRemoveButton:iX}=o0(M,ZX,_),lX=d0(M,ZX,_);return Z.Div({children:[Z.Div({class:"flex items-center justify-between",children:[Z.Div({class:"flex items-center ba bw1 b--light-silver br3 w-70 w-80-ns",children:[pX({classNames:"w1dot5 h2 br3 br--left ml1px",dotClassNames:"br3 br--left",colorIndex:K,level:_,isRectangular:!0,totalLevels:F.value.length}),PX({classNames:"bn pa2 br3 w-100 outline-0",placeholder:`Level ${_}`,disabled:lX,text:P.name,onchange:(aX)=>rX(aX,_)})]}),_1({hideAdd:nX,hideRemove:iX,onAdd:()=>sX(_+1),onRemove:()=>oX(_)})]}),Z.If({subject:_<F.value.length-1,isTruthy:Z.Div({class:"pa2 ml2 pl1 bl bw1 b--light-gray"})})]})}})}),S({title:"Milestones",hideDescription:J,description:B`
                  Miltestones are something long-term. Let's say after a month or two, you followed
                  your habit for 67% of the times, then based on below table you crossed the '${()=>n(Q.value.milestones,67).label}' milestone. You can set your own milestone levels depending
                  on the difficulty of the habit.
                `,children:Z.For({subject:R(()=>NX(O.value)),n:0,nthChild:Z.Div({class:"mb1 ph2 pv0 bn bw1 relative ts-white-1",children:[Z.Span({class:"lh-copy",children:""}),Z.Span({class:"w-30 absolute mt3 right-2 bottom--1dot5 flex items-center z-1",children:[Z.Span({class:"w-100 bg-white bn bw1 ph2dot5 di f4 b light-silver pb3 nl1",children:"100"}),Z.Span({class:"ph2 bg-white light-silver b pb3 mr1",children:"%"})]})]}),map:(P,_)=>Z.Div({class:"mb1 ph4 pv4 ba br3 bw1 b--light-gray relative",children:[Z.Span({class:"lh-copy flex items-center",children:[E({className:`mr2 ${P.color}`,size:20,iconName:P.icon}),P.label]}),Z.Span({class:"w-30 absolute mt3 right-2 bottom--1dot5 flex items-center z-1",children:[Z.If({subject:_===3,isTruthy:Z.Span({class:"w-100 bg-white bn bw1 br3 pa2dot5 di f4 b light-silver mb1",children:"00"}),isFalsy:P1({classNames:"w-100 ba bw1 b--light-silver br3 pa2dot5 di f5 b dark-gray",num:P.percent,onchange:(M)=>dX(M,_)})}),Z.Span({class:"ph2 bg-white light-silver b",children:"%"})]})]})})})])}),Z.If({subject:W,isFalsy:H({className:"pv2 ph3 flex items-center",onTap:()=>z.value=!z.value,children:[E({className:"mr1",iconName:R(()=>z.value?"remove":"add")}),B`Show ${()=>z.value?"Less":"More"} Customisations`]})})]})}),O1=f(({editableHabit:X,onMount:$})=>{let Q=T(b.editPage),J=T(!1),W=T(!1),Y=T(""),z=T(m0()),U=R(()=>X?.value?`Edit '${X.value.title}'`:"Add new habit");x(()=>console.log(Q.value.showHints));let q=()=>J.value=!0,G=()=>J.value=!1,F=()=>{G(),history.go(-2)},O=()=>{if(Y.value=r0(z.value,!X?.value),Y.value)return;let j=z.value,w=[...X?.value?.levels||[]],V=l0(w,j.levels,j.tracker);q1({...z.value,tracker:V}),history.back()};return j1({onMount:()=>{if($)$(),z.value=X?.value;Q.value=R1()},body:uX({classNames:"bg-white ph3",header:Z.Div({class:B`${()=>U.value.length>22?"f2dot66":""}`,children:U}),content:Z.Div([Z.If({subject:X,isTruthy:Z.Div([S({classNames:"pb2",title:"Actions",children:[V1({isOpen:J,habit:z,onClose:G,onDone:F}),_X({classNames:"db mb3 f6 red",children:"Delete this habit permanently along with its data",onClick:q}),o({classNames:"bn",isOpen:W,onTapOutside:()=>W.value=!1,content:Z.Div({class:"pa3 f5",children:[Z.Div({class:"mb3 b f4",children:B`Stop '${()=>z.value.title}'?`}),Z.Div({class:"mb4",children:[`
                          This action is not reversible. You will not be able to resume it again.`,Z.Br({}),Z.Br({}),`
                          Are you sure, you want to STOP this habit permanently?
                          `]}),Z.Div({class:"flex items-center justify-between f6",children:[H({className:"w-100 pv2 ph3 mr2",children:"No, go back",onTap:()=>W.value=!1}),H({className:"w-100 pv2 ph3 ml2 b",children:"Yes, stop this",onTap:()=>{G1(z.value.id),W.value=!1,history.back()}})]})]})}),_X({classNames:"db mb3 f6 gray",children:"Stop this habit permanently and keep it for future",onClick:()=>W.value=!0})]})])}),w1({editableHabit:X,editedHabit:z,hideDescriptions:R(()=>!Q.value.showHints),showFullCustomisations:s(Q).prop("showFullCustomisation"),onChange:(j)=>z.value=j})]),bottombar:Z.Div({class:"bg-white w-100 pv3",children:[Z.If({subject:Y,isTruthy:Z.Div({class:"red mb3",children:Y})}),Z.Div({class:"flex items-center justify-stretch",children:[K1({classNames:"w4dot50 w4dot25-ns"}),H({className:"w-100 pa3 ml3 b",children:R(()=>X?.value?"Update":"Add"),onTap:O})]})]})})})}),V1=f(({isOpen:X,habit:$,onClose:Q,onDone:J})=>{return o({classNames:"bn w-30-ns",isOpen:X,onTapOutside:Q,content:Z.Div({class:"pa3 f5",children:[Z.Div({class:"mb3 b f4",children:B`Delete '${()=>$.value?.title}'?`}),Z.Div({class:"mb4",children:[`
              All the data and the acheivements associated with this habit will be lost forever
              with this action, and cannot be reversed.
              `,Z.Br({}),Z.Br({}),`
              Are you sure, you want to DELETE this habit permanently?
              `]}),Z.Div({class:"flex items-center justify-between f6",children:[H({className:"w-25 pv2 ph3 mr1 b",children:"No",onTap:Q}),H({className:"pv2 ph3 ml2 b red",children:"Yes, delete permanently",onTap:()=>{B1($.value.id),J()}})]})]})})}),N1=f(({isOpen:X,habit:$,date:Q,showTitleInHeader:J,onClose:W,onChange:Y})=>{return o({classNames:"f5 normal ba bw0 outline-0",isOpen:X,onTapOutside:W,content:Z.Div({class:"mnw5",children:[Z.Div({class:"f5 b tc pa3",children:B`Change status ${()=>J?.value?`of  '${$.value.title}'`:`for ${Q.value.toDateString()}`}`}),Z.Div({class:"f5 mb1",children:Z.For({subject:R(()=>$.value.levels||[]),map:(z,U)=>{let q=B`pointer flex items-center pv3 pa3 bt b--moon-gray ${()=>u0($.value.tracker,Q.value)?.level.code===U?"bg-near-white black":"gray"}`;return Z.Div({class:q,onclick:D(()=>Y(U)),children:[Z.Span(z.name)]})}})})]})})}),k1=f(({classNames:X,links:$})=>{return Z.Div({class:B`flex items-center justify-between pv3 bg-near-white ${X}`,children:Z.For({subject:$,map:(Q)=>D1({label:Q.label,icon:Q.icon,isSelected:Q.isSelected,href:Q.href})})})}),D1=f(({classNames:X,label:$,icon:Q,isSelected:J,href:W})=>{return Z.Div({class:B`pointer noselect flex flex-column items-center justify-center ${()=>J.value?"app-theme-color b":"black"} ${X}`,onclick:D(()=>I0(W.value)),children:[E({size:22,iconName:Q}),Z.Div({class:"f7",children:$})]})}),C1=f(({classNames:X,header:$,content:Q,navbarTop:J,route:W})=>{return uX({classNames:X,header:$,content:Q,bottombar:Z.Div({children:[Z.If({subject:J,isTruthy:J}),k1({classNames:"nl3 nr3 ph4",links:R(()=>[{label:"Today",icon:"calendar_month",isSelected:W.value==="/",href:"/"},{label:"Habits",icon:"checklist",isSelected:W.value==="/habits/",href:"/habits/"},{label:"Settings",icon:"settings",isSelected:W.value==="/settings/",href:"/settings/"}])})]})})}),S=f(({classNames:X,contentClassNames:$,title:Q,description:J,hideDescription:W,children:Y})=>{return Z.Div({class:B`mt3 mb4 ${X}`,children:[Z.Div({class:"mb2 dark-gray f4 b",children:Q}),Z.If({subject:R(()=>J?.value&&!W?.value),isTruthy:Z.Div({class:"mb3 f6 silver fw5",children:B`${J}`})}),Z.Div({class:$,children:Y})]})}),I1=f(({classNames:X,iconSize:$,selectedOptionIndex:Q,onChange:J})=>{let W=T(!1),Y=R(()=>FX[Q.value]),z=(U)=>{J(U),W.value=!1};return Z.Div({class:X,children:[jX({classNames:"pointer",descending:R(()=>Y.value.decending),iconName:R(()=>Y.value.icon),size:R(()=>$?.value??20),onClick:()=>W.value=!0}),o({classNames:"f5 normal ba bw0 outline-0",isOpen:W,onTapOutside:()=>W.value=!1,content:Z.Div({children:[Z.Div({class:"f5 b tc pv3",children:"Sort habit cards by"}),Z.Div({class:"f5 mb1",children:Z.For({subject:FX,map:(U,q)=>{let G=B`pointer flex items-center pv3 pl2 pr3 bt b--moon-gray ${()=>U.label===Y.value.label?"bg-near-white black":"gray"}`;return Z.Div({class:G,onclick:D(()=>z(q)),children:[jX({classNames:"ml1 mr2",descending:U.decending,iconName:U.icon,size:20}),Z.Span(U.label)]})}})})]})})]})}),jX=f(({classNames:X,descending:$,iconName:Q,size:J,onClick:W})=>{return Z.Span({class:B`flex items-center ${()=>W?"pointer":""} ${X}`,onclick:D(W),children:[E({className:"silver",size:R(()=>4*J.value/5),iconName:R(()=>$.value?"arrow_upward":"arrow_downward")}),E({className:"",size:J,iconName:Q})]})}),mX=T(void 0),M1=()=>{let X=v0();if(!X)throw"Invalid habit ID in query params. No habit fetched.";mX.value=X},A1=O1({editableHabit:mX,onMount:M1}),T1=()=>{A.start("mount"),kX.resetIdCounter(),A1(),A.start("run")};T1();
