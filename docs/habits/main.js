var l=(X)=>{let $=Object.entries(X).sort((J,Q)=>J[0].localeCompare(Q[0]));return $.forEach(([J,Q],Z)=>{if(Q&&typeof Q==="object"&&!Array.isArray(Q))$[Z]=[J,l(Q)]}),Object.fromEntries($)},XX=(X)=>{if(typeof X!=="object"||X===null||Array.isArray(X))return!1;return Object.prototype.toString.call(X)==="[object Object]"},s=(X)=>{if(Array.isArray(X)){let $=[...X],J=[];return $.forEach((Q)=>{J.push(s(Q))}),J}if(XX(X)){let $={...X},J={};return Object.keys($).forEach((Q)=>{J[Q]=s($[Q])}),Object.freeze(J)}return X},b=(X)=>{if(Array.isArray(X)){let J=[...X],Q=[];return J.forEach((Z)=>{Q.push(b(Z))}),Q}if(XX(X)){let J={...X},Q={};return Object.keys(J).forEach((Z)=>{Q[Z]=b(J[Z])}),Q}return X},zX=(X,$="index")=>X.map((J,Q)=>({[$]:Q,value:J})),nX=(X,$)=>{let J=l(X),Q=l($),Z=Object.keys(J),z=Object.keys(Q);if(Z.length!==z.length)return!1;for(let Y of Z)if(!z.includes(Y)||!$X(J[Y],Q[Y]))return!1;return!0},iX=(X,$)=>{if(X.length!==$.length)return!1;if(X.length===0)return!0;for(let J=0;J<X.length;J++)if(!$X(X[J],$[J]))return!1;return!0},$X=(X,$)=>{if(typeof X!==typeof $)return!1;if(Array.isArray(X))return iX(X,$);if(X===null||$===null)return X===$;if(typeof X==="object"&&!(X instanceof Set))return nX(X,$);if(typeof X==="bigint"||typeof X==="number"||typeof X==="string"||typeof X==="boolean")return X===$;return X===$},lX=(X,$,J)=>{let Z=zX(b(X),"index");return zX(b($),"index").map((Y)=>{let U="add",F=-1,R=Y.value;return Z.some((B,j)=>{if(U=$X(B.value,Y.value)?B.index===Y.index?"idle":"shuffle":J&&B.value[J]!==void 0&&B.value[J]===Y.value[J]?"update":"add",U!=="add")return F=B.index,Z.splice(j,1),!0;return!1}),{type:U,oldIndex:F,value:R}})},S=(X)=>["source-signal","derived-signal"].includes(X?.type),fX=(X,$)=>X?.type==="non-signal"&&(!$||!$.length||$.some((J)=>typeof X?.value===J)),JX=(X)=>S(X)||fX(X),wX=(X)=>fX(X,["string"]),kX=(X)=>X?.type==="non-signal"&&Array.isArray(X?.value)&&(X?.value).every(($)=>typeof $==="string"),c=(X)=>JX(X)?X.value:X,r=null,V=(X)=>{let $=s(X),J=new Set;return{type:"source-signal",get value(){if(r)J.add(r);return b($)},set value(Q){if(Q===$)return;$=s(Q),J.forEach((Z)=>Z&&Z())}}},y=(X)=>{r=X,X(),r=null},q=(X)=>{let $,J=V($);return y(()=>{$=X($),J.value=$}),{type:"derived-signal",get prevValue(){return $},get value(){return J.value}}},AX=(X)=>{if(!XX(X.value))throw new Error("Thee argument should be a plain object or a signal of plain object");return{prop:($)=>q(()=>X.value[$]),get props(){return Object.keys(X.value).reduce((J,Q)=>{let Z=Q;return J[Z]=this.prop(Z),J},{})}}},P=(X,...$)=>q(()=>{return X.reduce((J,Q,Z)=>{let z,Y=$[Z];if(typeof Y==="function")z=Y()??"";else if(JX(Y))z=Y.value??"";else z=Y??"";return`${J}${Q}${z.toString()}`},"")}),TX=["onmount","onunmount"],HX=["onerror","onload","onresize","onblur","onchange","oncontextmenu","onfocus","oninput","oninvalid","onreset","onselect","onsubmit","onkeydown","onkeypress","onkeyup","onclick","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onscroll","onabort","oncanplay","oncanplaythrough","ondurationchange","onemptied","onended","onerror","onloadeddata","onloadedmetadata","onloadstart","onpause","onplay","onplaying","onprogress","onratechange","onseeked","onseeking","onstalled","onsuspend","ontimeupdate","onvolumechange","onwaiting"],aX=[...HX,...TX],tX=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"],p,eX=(X)=>{if(!p)p=document.createElement("textarea");return p.innerHTML=X,p.value},X0=()=>{let X=0;return{getNewId:()=>++X,resetIdCounter:()=>X=0}},LX=X0(),O={currentIs:(X)=>window._currentAppPhase===X,start:(X)=>{window._currentAppPhase=X,console.log(`Current phase is ${X}`)}},o=(X)=>Array.isArray(X),d=(X)=>!isNaN(X?.elementId)&&X?.elementId>0,g=(X)=>typeof X==="string"||typeof X==="function"&&X.isElementGetter,QX=(X)=>S(X)&&g(X.value),$0=(X)=>g(X)||QX(X),VX=(X)=>{return S(X)&&(g(X.value)||o(X.value)&&X.value.every(($)=>g($)))},MX=(X)=>{return!S(X)&&(wX(X)||kX(X)||g(X)||o(X)&&X.every(($)=>$0($)))},ZX=(X)=>{return VX(X)||MX(X)},UX=!1,J0={},I={},Q0=globalThis.MutationObserver,Z0=new Q0((X)=>{X.forEach(($)=>{if($.type==="childList")$.addedNodes.forEach((J)=>{if(d(J)){let Q=J,Z=Q.elementId;if(I[Z])delete I[Z];else J0[Z]=Q.tagName}}),$.removedNodes.forEach((J)=>{if(d(J)){let Q=J,Z=Q.elementId,z=Q.unmountListener;if(z)I[Z]={element:Q,unmountListener:z}}})}),Object.entries(I).forEach(([$,J])=>{let{element:Q,unmountListener:Z}=J;EX(Q,Z)})}),EX=(X,$)=>{if(!d(X))return;let J=X.children;for(let Q=0;Q<J.length;Q++){let Z=J[Q];EX(Z,Z.unmountListener)}if($&&$(X),I[X.elementId])delete I[X.elementId]},W0=()=>{if(!UX&&!O.currentIs("build"))Z0.observe(document.body,{childList:!0,subtree:!0}),UX=!0},OX=(X,$)=>aX.includes(X)&&$===void 0,SX=(X,$)=>HX.includes(X)&&typeof $==="function",xX=(X,$)=>TX.includes(X)&&typeof $==="function",Y0=(X,$)=>OX(X,$)||SX(X,$)||xX(X,$),z0=(X,$)=>{Object.entries($).forEach(([J,Q])=>{if(OX(J,Q));else if(SX(J,Q)){let Z=J.slice(2);X.addEventListener(Z,(z)=>{if(Z==="keypress")z.preventDefault();Q(z)})}else if(xX(J,Q)){if(J==="onmount"&&!O.currentIs("build")){let Z=Q;setTimeout(()=>Z(X),0)}if(J==="onunmount")W0(),X.unmountListener=Q}else console.error(`Invalid event key: ${J} for element with tagName: ${X.tagName}`)})},qX=(X,$,J)=>{let Q=(JX(J)?J.value:J)??"";if(typeof Q==="boolean")if(Q)X.setAttribute($,"");else X.removeAttribute($);else if($==="value")X.value=Q;else if(Q)X.setAttribute($,Q)},U0=(X,$)=>{let J={};Object.entries($).forEach((Q)=>{let[Z,z]=Q;if(S(z))J[Z]=z;qX(X,Z,z)}),y(()=>{Object.entries(J).forEach((Q)=>{let[Z,z]=Q,Y=z.value;if(!O.currentIs("run"))return;qX(X,Z,Y)})})},m=(X)=>{if(QX(X)){let $=X.value;return m($)}if(typeof X==="string")return document.createTextNode(eX(X));if(g(X)){let $=X();if(!d($))throw new Error(`Invalid MHtml element getter child. Type: ${typeof X}`);return $}throw new Error(`Invalid child. Type of child: ${typeof X}`)},q0=(X,$)=>{if(!$)return;if(VX($))y(()=>{let Q=$.value,Z=o(Q)?Q:[Q];Z.forEach((Y,U)=>{let F=X.childNodes[U],R=m(Y);if(F&&R)X.replaceChild(R,F);else if(R)X.appendChild(R);else console.error(`No child found for node with tagName: ${X.tagName}`)});let z=Z.length;while(z<X.childNodes.length){let Y=X.childNodes[z];if(Y)X.removeChild(Y)}});if(MX($)){let J=wX($)?[$.value]:kX($)?$.value:o($)?$:[$],Q=[];if(J.forEach((Z,z)=>{if(QX(Z))Q.push({index:z,childSignal:Z});let Y=m(Z),U=X.childNodes[z];if(U&&Y)X.replaceChild(Y,U);else if(!U&&Y)X.appendChild(Y);else console.error(`No child found for node with tagName: ${X.tagName}`)}),Q.length)Q.forEach(({index:Z,childSignal:z})=>{y(()=>{if(!z.value)return;if(!O.currentIs("run"))return;let Y=m(z.value),U=X.childNodes[Z];if(U&&Y)X.replaceChild(Y,U);else if(!U&&Y)X.appendChild(Y);else console.error(`No child found for node with tagName: ${X.tagName}`)})})}},G0=(X,$)=>{let J=void 0,Q={},Z={};return Object.entries(X).forEach(([z,Y])=>{if(z==="children")if(ZX(Y))J=Y;else if(Y===void 0)J=Y;else throw new Error(`Invalid children prop for node with tagName: ${$}

 ${JSON.stringify(Y)}`);else if(Y0(z,Y))Q[z]=Y;else Z[z]=Y}),{children:J,eventProps:Q,attributeProps:Z}},B0=(X,$)=>{let J=()=>{let Q=LX.getNewId(),Z=O.currentIs("mount")?document.querySelector(`[data-elem-id="${Q}"]`):document.createElement(X);Z.elementId=Q,Z.unmountListener=void 0;let z=ZX($)?{children:$}:$;if(!O.currentIs("run"))z["data-elem-id"]=Z.elementId.toString();let Y=G0(z,Z.tagName);if(z0(Z,Y.eventProps),U0(Z,Y.attributeProps),q0(Z,Y.children),!O.currentIs("build"))Z.removeAttribute("data-elem-id");return Z};return J.isElementGetter=!0,J},GX=(X,$,J)=>{let Q=V($),Z=V(X),z=J(q(()=>Z.value),q(()=>Q.value)),Y,U,F=!1;if(z?.isElementGetter)Y=()=>{if(F&&U)return U;return U=z(),F=!0,U},Y.isElementGetter=!0;else if(typeof z==="string")Y=z;else throw`One of the child, ${z} passed in ForElement is invalid.`;return{indexSignal:Q,itemSignal:Z,mappedChild:Y}},BX=(X,$,J)=>{if($!==void 0&&$>=0&&J){let Q=$>X.length?X.length:$;X.splice(Q,0,J)}return X},F0=({subject:X,itemKey:$,map:J,n:Q,nthChild:Z})=>{if(Z&&Q===void 0||Q!==void 0&&Q>-1&&!Z)throw new Error("Either both 'n' and 'nthChild' be passed or none of them.");let z=q(()=>{let K=c(X);return Array.isArray(K)?K:[]});if(!$)return q(()=>BX(z.value.map(J),Q,Z));let Y=Z;if(Z&&typeof Z!=="string"){let K=Z(),D=()=>K;D.isElementGetter=!0,Y=D}let U=z.value;if(U.length&&typeof U[0]!=="object")throw new Error("for mutable map, item in the list must be an object");let F=null,R=q((K)=>{return F=K||F,z.value}),B=q((K)=>{if(!K||!F)return R.value.map((H,A)=>GX(H,A,J));return lX(F,R.value,$).map((w,H)=>{let A=(K||[])[w.oldIndex];if(console.assert(w.type==="add"&&w.oldIndex===-1&&!A||w.oldIndex>-1&&!!A,"In case of mutation type 'add' oldIndex should be '-1', or else oldIndex should always be a non-negative integer."),A){if(w.type==="shuffle")A.indexSignal.value=H;if(w.type==="update")A.indexSignal.value=H,A.itemSignal.value={...w.value};return A}return GX(w.value,H,J)})});return q(()=>BX(B.value.map((K)=>K.mappedChild),Q,Y))},R0=({subject:X,isTruthy:$,isFalsy:J})=>{let Q=W.Span({style:"display: none;"}),Z=()=>(c(X)?$:J)||Q;return S(X)?q(Z):Z()},_0=({subject:X,caseMatcher:$,defaultCase:J,cases:Q})=>{let Z=()=>{let z=c(X),Y=void 0;for(let[U,F]of Object.entries(Q))if($&&$(X,U)||z===U){Y=F;break}return Y||J||W.Span({style:"display: none;"})};return S(X)?q(Z):Z()},P0=tX.reduce((X,$)=>{let J=$.split("").map((Z,z)=>!z?Z.toUpperCase():Z).join(""),Q=(Z)=>B0($,Z);return X[J]=Q,X},{}),K0={For:F0,If:R0,Switch:_0},W={...P0,...K0},k=(X)=>($)=>{for(let Q of Object.keys($))if($[Q]===void 0)delete $[Q];let J=Object.entries($).reduce((Q,Z)=>{let[z,Y]=Z,U=typeof Y==="string",F=Array.isArray(Y)&&Y.every((B)=>typeof B==="string"),R=S(Y)||typeof Y==="function"?Y:U||F?{type:"non-signal",get value(){return c(Y)}}:ZX(Y)?Y:{type:"non-signal",get value(){return c(Y)}};return Q[z]=R,Q},{});return X(J)},NX=86400000,j0=1.6181,CX={id:"local-settings",habitsPage:{tabIndex:0,sortOptionIndex:0}},IX=[{label:"5 months",months:5},{label:"2 months",months:2},{label:"This month",months:1}],a=[{icon:"calendar_month",decending:!0,label:"Date created (Newest first)"},{icon:"calendar_month",decending:!1,label:"Date created (Oldest first)"},{icon:"task_alt",decending:!0,label:"Completion (Highest first)"},{icon:"task_alt",decending:!1,label:"Completion (Lowest first)"}],D0=[1,1,1,1,1,1,1],f0=["Not done","Done"],w0=[90,75,50],k0=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],A0=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],T0=["January","February","March","April","May","June","July","August","September","October","November","December"],yX=["#e87b52","#F5B971","#F5E06F","#A3BA64","#679A9E","#7095C9","#A59EE3","#D89DBF"],H0=(X)=>{let $=new Date().getTime();return{id:X?$-NX*X:$,title:"",frequency:D0,colorIndex:0,levels:f0,tracker:[],milestones:w0,pauses:[],isStopped:!1}},gX=(X)=>[{label:"Successful",percent:X[0],icon:"verified_user",color:"green"},{label:"Little more to go",percent:X[1],icon:"done_all",color:"light-blue"},{label:"Going good",percent:X[2],icon:"check",color:"blue"},{label:"Unacceptable",percent:0,icon:"close",color:"red"}],FX=(X,$)=>{let J=gX(X),Q=J[0];for(let Z=0;Z<J.length;Z++)if(Q=J[Z],Q.percent<$)break;return Q},L0=(X)=>{if(!X.title)return"Title should not be empty";if(X.frequency.every(($)=>!$))return"Select at least one day in a week";if(!X.levels.every(($)=>!!$))return"One of the levels is empty";if(!X.milestones.every(($)=>$<=100&&$>=0))return"The milestones should be between 0 and 100 percents";if(!X.milestones.every(($,J,Q)=>J===0?!0:Q[J-1]>$))return"Milestones should be in order (from high to low)";return""},V0=()=>{if(!location)return[];return location.href.split("?")[1].split("&")},RX=(X)=>{return new Date(X.getFullYear(),X.getMonth(),X.getDate())},M0=(X,$)=>{let{id:J,tracker:Q}=X,Z=$.getFullYear(),z=$.getMonth(),Y=[...k0],U=new Date(J),F=U.getFullYear(),R=U.getMonth(),B=U.getDate();for(let j=0;j<Q.length;j++){let K=new Date(F,R,B+j),D=K.getFullYear(),w=K.getMonth();if(D>Z)break;if(D===Z&&w>z)break;if(D===Z&&w===z){let H=K.getDate();Y[H-1]=Q[j]}}return Y},bX=(X,$)=>{let J=new Date;return Array($).fill(0).map((Z,z)=>new Date(J.getFullYear(),J.getMonth()-z,1)).reverse().map((Z)=>({monthIndex:Z.getMonth(),status:M0(X,Z)}))},E0=(X,$)=>{let J=RX(X),Q=RX($);return Math.round((Q.getTime()-J.getTime())/NX)},O0=(X,$)=>{let J=bX(X,$),Q=X.levels.length-1,Z=0,z=0;for(let Y of J)for(let U of Y.status)if(U>-1)z++,Z+=U;return Math.ceil(Z/(z*Q)*100)},T=(X)=>{return(...$)=>{if(window.navigator?.vibrate)window.navigator.vibrate(3);return X&&X(...$)}},S0=()=>{let X=[];for(let $ in localStorage){if(!$.startsWith("h."))continue;let J=JSON.parse(localStorage.getItem($)||"");if(typeof J!=="object")continue;X.push(J)}return X},x0=(X)=>{let $=localStorage.getItem(X),J=JSON.parse($||"");if(!J)throw`Error fetching habit with id '${X}' from storage`;return J},N0=()=>{for(let X in localStorage){if(!X.startsWith("h."))continue;let $=JSON.parse(localStorage.getItem(X)||"{}");if(typeof $!=="object"||!$.title)continue;let J=`h.${$.id}`,Q=new Date($.id),z=E0(Q,new Date),Y=[...$.tracker];if(z+1<=Y.length)continue;for(let U=Y.length;U<=z;U++){let R=new Date(Q.getFullYear(),Q.getMonth(),Q.getDate()+U).getDay();Y[U]=$.frequency[R]?0:-1}$.tracker=Y,localStorage.setItem(J,JSON.stringify($))}},C0=(X,$)=>{localStorage.setItem(X,JSON.stringify($))},I0=()=>{let X=V0();if(!X.length);let $,J="";for(let Q of X){if(!Q.startsWith("id="))continue;let z=+(Q.split("id=").pop()||"__");if(!z||isNaN(z))continue;let Y=`h.${z}`;try{$=x0(Y)}catch(U){J=U.toString()}}return[$,J]},y0=()=>{localStorage.setItem("settings",JSON.stringify(CX))},g0=()=>{if(!globalThis.localStorage)return CX;let X=localStorage.getItem("settings")||"{}",$=JSON.parse(X);if(!(typeof $==="object"&&$.id==="local-settings"))y0();return JSON.parse(localStorage.getItem("settings"))},N=V(g0());y(()=>{let X=N.value;if(globalThis.localStorage)localStorage.setItem("settings",JSON.stringify(X))});var b0=k(({classNames:X,hideRemove:$,hideAdd:J,onRemove:Q,onAdd:Z})=>{return W.Span({class:P`br3 pb1 f4 bw1 b--light-silver dark-gray ${()=>$?.value&&J?.value?"bn":"ba"} ${X}`,children:[W.If({subject:$,isFalsy:W.Span({class:P`pointer ph2 pb1 bw1 b--light-silver ${()=>J?.value?"":"br"}`,onclick:T(Q),children:"-"})}),W.If({subject:J,isFalsy:W.Span({class:"pointer ph2 pb1",onclick:T(Z),children:"+"})})]})}),x=k(({className:X,onTap:$,children:J})=>W.Button({class:P`pointer br-pill ba bw1 b--light-silver b--hover-black bg-white black ${X}`,onclick:T(()=>$()),children:J})),cX=k(({classNames:X,colorIndex:$,level:J,totalLevels:Q,textContent:Z,showText:z,onClick:Y})=>{let U=q(()=>yX[$.value]),F=q(()=>Math.trunc(Math.pow(J.value/(Q.value-1),j0)*255)),R=q(()=>{let K=F.value.toString(16);return K.length===1?`0${K}`:K}),B=q(()=>J.value<0||R.value==="0"?"transparent":`${U.value}${R.value}`),j=q(()=>z?.value?J.value/(Q.value-1)>0.5?"white":"black":J.value<0?"lightgray":"transparent");return W.Span({class:P`pointer br-100 relative ${()=>J.value<0?"transparent":"bg-near-white"} ${X}`,onclick:T(()=>Y&&J.value>=0&&Y()),children:[W.Span({class:P`flex items-center justify-around absolute absolute--fill br-100 pt05`,style:P`
            background-color: ${B};
            color: ${j};
          `,children:q(()=>Z?.value||"·")})]})}),h=k(({className:X,size:$,onClick:J,iconName:Q,title:Z})=>W.Span({class:P`material-symbols-rounded ${()=>J?"pointer":""} ${X}`,style:P`font-size: ${()=>$?.value||"16"}px`,onclick:T(J),children:Q,title:Z})),_X=k(({classNames:X,href:$,target:J,onClick:Q,children:Z})=>{return W.A({class:P`${()=>!$&&!Q?"":"pointer underline"} ${X}`,href:$,target:J,onclick:T(Q),children:Z})}),t=k(({classNames:X,isOpen:$,content:J,onTapOutside:Q})=>{return W.Dialog({onmount:(Z)=>setTimeout(()=>y(()=>{if($.value)Z.showModal();else Z.close()})),onclick:T(Q),class:P`pa0 br3 ${X}`,children:[W.Div({onclick:(Z)=>Z.stopPropagation(),children:J})]})}),c0=k(({classNames:X,placeholder:$,num:J,onchange:Q})=>{let Z=(z)=>{let Y=z.target.value,U=Number.parseFloat(Number.parseFloat(Y||"0").toFixed(2));Q(U)};return W.Input({class:X,type:"number",placeholder:$,value:P`${()=>J.value??""}`,onchange:Z})}),hX=k(({classNames:X,body:$,onMount:J})=>{return W.Html({lang:"en",children:[W.Head({children:[W.Title("Maya App"),W.Meta({charset:"UTF-8"}),W.Meta({"http-equiv":"X-UA-Compatible",content:"IE=edge"}),W.Meta({name:"viewport",content:"width=device-width, initial-scale=1.0"}),W.Link({rel:"stylesheet",href:"/assets/styles.css"})]}),W.Body({class:X,onmount:J,children:[W.Script({src:"main.js",defer:"true"}),$]})]})}),d0=k(({progress:X,classNames:$})=>{let J=P`width: ${()=>X.value<0?0:X.value>100?100:X.value}%;`;return W.Div({class:P`br-pill bg-moon-gray ${$}`,children:W.Div({class:"br-pill bg-app-theme-color pa1",style:J})})}),vX=k(({classNames:X,header:$,content:J,bottombar:Q})=>{return W.Div({class:"flex-ns justify-center-ns",children:W.Div({class:P`w6-ns ${X}`,children:[W.If({subject:$,isTruthy:W.Div({class:"overflow-break-word sticky top-0 left-0 right-0 bg-inherit z-999 f2dot33 b pv3 mt2",children:$})}),J,W.Div({class:"pv6 mt5"}),W.If({subject:Q,isTruthy:W.Div({class:"sticky bottom-0 left-0 right-0 z-9999",children:Q})})]})})}),h0=k(({classNames:X,tabItemClassNames:$,selectedTabClassNames:J,tabs:Q,selectedTabIndex:Z,onTabChange:z})=>{return W.Div({class:P`bg-near-white br3 ${X}`,children:W.Div({class:"flex items-center justify-between pa1",children:W.For({subject:Q,map:(Y,U)=>W.Span({class:P`w-100 br3 pa1 flex justify-center ${()=>U===Z.value?`bg-white black ${J?.value}`:"bg-transparent silver pointer"} ${$}`,onclick:T(()=>z(U)),children:Y})})})})}),PX=k(({classNames:X,placeholder:$,disabled:J,text:Q,onmount:Z,onchange:z,onkeydown:Y,onfocus:U,onblur:F})=>{let R,B=(D)=>{if(R=D,Z)Z(D)},j=(D)=>{let w=D.target.value;if(z)z(w)},K=(D)=>{let w=D.key.length===1?R.value+D.key:D.key==="Backspace"?R.value.slice(0,-1):R.value,H={key:D.key,text:w};if(Y)Y(H)};return W.Input({onmount:B,class:P`${X}`,type:"text",placeholder:$,disabled:J,value:Q,onchange:j,onkeydown:K,onfocus:U,onblur:F})}),v0=k(({classNames:X,status:$,month:J,colorIndex:Q,totalLevels:Z})=>{return W.Div({class:P`flex items-center ${X}`,children:[W.Div({class:"f8 b w1 light-silver",children:q(()=>J.value.charAt(0))}),W.Div({class:"w-100 flex items-center justify-between",children:W.For({subject:$,map:(z)=>cX({classNames:"pa1",colorIndex:Q,level:z,totalLevels:Z})})})]})}),KX=k(({classNames:X,habit:$,months:J,onClick:Q})=>{let{milestones:Z,title:z,completion:Y,colorIndex:U,levels:F}=AX(q(()=>$.value)).props,R=q(()=>bX($.value,J.value)),B=q(()=>FX(Z.value,Y.value).icon),j=q(()=>FX(Z.value,Y.value).color);return W.Div({class:P`pointer bg-white br4 pa3 ${X}`,onclick:T(Q),children:[W.Div({class:"flex items-center justify-between nt1 mb2",children:[W.Div({class:"f4 dark-gray b",children:z}),W.Div({class:"f6 silver b flex items-center",children:[h({className:P`mr1 ${j}`,iconName:B}),P`${Y}%`]})]}),W.Div({class:"mt3 mb1",children:W.For({subject:R,map:(K)=>v0({classNames:"mb1",month:T0[K.monthIndex],status:K.status,colorIndex:U,totalLevels:F.value.length})})})]})}),u0=k(({classNames:X,habit:$,initialLevels:J,onChange:Q})=>{let{title:Z,frequency:z,levels:Y,milestones:U,colorIndex:F}=AX($).props,R=q(()=>z.value.every((G)=>!!G)),B="bg-mid-gray white",j="bg-near-white light-silver",K=(G)=>{Q({...$.value,title:G})},D=(G)=>{Q({...$.value,colorIndex:G})},w=(G)=>{if(G<-1||G>6)throw"Invalid day index";if(G===-1){Q({...$.value,frequency:[1,1,1,1,1,1,1]});return}let _=R.value?z.value.map((f)=>0):z.value;_[G]=R.value?1:_[G]?0:1,Q({...$.value,frequency:_})},H=(G,_)=>{let f=Y.value;f[_]=G,Q({...$.value,levels:f})},A=(G,_=!0)=>{let f=Y.value;if(_)f.splice(G,0,"");else f.splice(G,1);Q({...$.value,levels:f})},M=(G)=>A(G),L=(G)=>{if(Y.value.length<3)return;A(G,!1)},E=(G,_)=>{if(_<0||_>2)throw"Incorrect index of milestone passed. Milestone values should not be more than 3.";let f=[...$.value.milestones];f[_]=G,Q({...$.value,milestones:f})};return W.Div({class:X,children:[C({title:"Color",child:W.Div({class:"mb1 flex items-center justify-between justify-start-ns",children:W.For({subject:yX,map:(G,_)=>{let f=q(()=>_===F.value?"#999":"#f4f4f4");return W.Span({class:"pointer mb2 mr3-ns pa1 br-100 bw2 ba flex",style:P`border-color: ${f}`,onclick:T(()=>D(_)),children:W.Span({class:P`pa2 br-100`,style:`background-color: ${G}`})})}})})}),C({classNames:"pb1",title:"Title",child:PX({classNames:"ba bw1 b--light-silver br3 pa2 w-100",placeholder:"title of target habit",text:Z,onchange:K})}),C({classNames:"pb1",title:"Frequency",child:W.Div({class:"mb3 f6 flex items-center justify-between justify-start-ns",children:W.For({subject:A0,n:0,nthChild:W.Span({class:P`pointer flex items-center justify-center br-pill h2 ph2 mr3-ns ${()=>R.value?"bg-mid-gray white":"bg-near-white light-silver"}`,children:"Daily",onclick:T(()=>w(-1))}),map:(G,_)=>{let f=q(()=>z.value[_]&&!R.value?"bg-mid-gray white":"bg-near-white light-silver");return W.Span({class:P`pointer flex items-center justify-center br-100 h2 w2 mr3-ns ${f}`,children:G.charAt(0),onclick:T(()=>w(_))})}})})}),C({classNames:"pb3",title:"Levels",child:W.Div({children:W.For({subject:Y,map:(G,_)=>{let f=$.value.levels.length<3,v=!!(J.value.length&&J.value.includes(G)),n=!!(J.value.length&&J.value.length!==$.value.levels.length),u=$.value.levels.length<J.value.length,YX=J.value.length&&!n&&!J.value.every((i,dX)=>i===$.value.levels[dX]),sX=u||YX||n&&u&&v,rX=f||u||YX||n&&!u&&v,oX=J.value.length!==$.value.levels.length&&J.value.includes(G);return W.Div({children:[W.Div({class:"flex items-center justify-between",children:[W.Div({class:"flex items-center w-80-ns",children:[cX({classNames:"pa2 mr2",colorIndex:F,level:_,totalLevels:Y.value.length}),PX({classNames:"ba bw1 b--light-silver br3 pa2 w-100",placeholder:`Level ${_}`,disabled:oX,text:G,onchange:(i)=>H(i,_)})]}),b0({hideAdd:sX,hideRemove:rX,onAdd:()=>M(_+1),onRemove:()=>L(_)})]}),W.If({subject:_<Y.value.length-1,isTruthy:W.Div({class:"pa2 ml2 bl bw1 b--light-gray"})})]})}})})}),C({title:"Milestones",child:W.Div({children:W.For({subject:q(()=>gX(U.value)),n:0,nthChild:W.Div({class:"mb1 ph2 pv0 bn bw1 relative ts-white-1",children:[W.Span({class:"lh-copy",children:""}),W.Span({class:"w-30 absolute mt3 right-2 bottom--1dot5 flex items-center z-1",children:[W.Span({class:"w-100 bg-white bn bw1 pa2dot5 di f4 b light-silver mb1 nl1",children:"100"}),W.Span({class:"ph2 bg-white light-silver b mr1",children:"%"})]})]}),map:(G,_)=>W.Div({class:"mb1 ph4 pv4 ba br3 bw1 b--light-gray relative",children:[W.Span({class:"lh-copy flex items-center",children:[h({className:`mr2 ${G.color}`,size:20,iconName:G.icon}),G.label]}),W.Span({class:"w-30 absolute mt3 right-2 bottom--1dot5 flex items-center z-1",children:[W.If({subject:_===3,isTruthy:W.Span({class:"w-100 bg-white bn bw1 br3 pa2dot5 di f4 b light-silver mb1",children:"00"}),isFalsy:c0({classNames:"w-100 ba bw1 b--light-silver br3 pa2dot5 di f5 b dark-gray",num:G.percent,onchange:(f)=>E(f,_)})}),W.Span({class:"ph2 bg-white light-silver b",children:"%"})]})]})})})})]})}),n0=k(({isNew:X})=>{let $=V(!1),J=V(!1),Q=V(""),Z=V(H0()),z=V([]),Y=q(()=>X.value?"New target habit":`Edit '${Z.value.title}'`),U=()=>{if(Q.value=L0(Z.value),Q.value)return;let B=Z.value,j=[...z.value],K=`h.${B.id}`,D=[...B.tracker],w=!!(!X.value&&j.length&&j.length!==B.levels.length),H=B.levels.length<j.length;if(w){let A=[];if(!H)j.forEach((M,L)=>{let E=B.levels.indexOf(M);if(E>-1&&E!==L){let _=[];B.tracker.forEach((f,v)=>{if(f===L)_.push(v)}),A.push({indices:_,newValue:E})}});else{let M=-1;for(let L=0;L<j.length;L++)if(j[L]!==B.levels[L]){M=L;break}if(M>=0)j.forEach((L,E)=>{if(E<=M)return;let G=[];B.tracker.forEach((_,f)=>{if(_===E)G.push(f)}),A.push({indices:G,newValue:E-1})})}A.forEach((M)=>{M.indices.forEach((L)=>{D[L]=M.newValue})})}C0(K,{...Z.value,tracker:D}),F()},F=()=>{location.href=X.value?"/habits/":`/habits/habit/?id=${Z.value.id}`};return hX({onMount:()=>{if(X.value)return;let[B,j]=I0();if(j||!B){Q.value=j||"Error fetching habit from 'id' given in query params";return}if(Z.value=B,!X.value)z.value=B.levels},body:vX({classNames:"bg-white ph3",header:W.Div({class:P`${()=>Y.value.length>22?"f2dot66":""}`,children:Y}),content:W.Div([W.If({subject:X,isFalsy:W.Div({class:"",children:[C({classNames:"pb2",title:"Actions",child:W.Div({children:[t({classNames:"bn",isOpen:$,onTapOutside:()=>$.value=!1,content:W.Div({class:"pa3 f5",children:[W.Div({class:"mb3 b f4",children:P`Delete '${()=>Z.value.title}'?`}),W.Div({class:"mb4",children:[`
                              All the data and the acheivements associated with this habit will be lost forever
                              with this action, and cannot be reversed.
                              `,W.Br({}),W.Br({}),`
                              Are you sure, you want to DELETE this habit permanently?
                              `]}),W.Div({class:"flex items-center justify-between f6",children:[x({className:"w-25 pv2 ph3 mr1 b",children:"No",onTap:()=>$.value=!1}),x({className:"pv2 ph3 ml2 b red",children:"Yes, delete permanently",onTap:()=>{let B=`h.${Z.value.id}`;localStorage.removeItem(B),$.value=!1,location.href="/habits/"}})]})]})}),_X({classNames:"db mb3 f6 red",children:"Delete this habit permanently along with its data",onClick:()=>$.value=!0}),t({classNames:"bn",isOpen:J,onTapOutside:()=>J.value=!1,content:W.Div({class:"pa3 f5",children:[W.Div({class:"mb3 b f4",children:P`Stop '${()=>Z.value.title}'?`}),W.Div({class:"mb4",children:[`
                              This action is not reversible. You will not be able to resume it again.`,W.Br({}),W.Br({}),`
                              Are you sure, you want to STOP this habit permanently?
                              `]}),W.Div({class:"flex items-center justify-between f6",children:[x({className:"w-100 pv2 ph3 mr2",children:"No, go back",onTap:()=>J.value=!1}),x({className:"w-100 pv2 ph3 ml2 b",children:"Yes, stop this",onTap:()=>{Z.value={...Z.value,isStopped:!0},U(),J.value=!1}})]})]})}),_X({classNames:"db mb3 f6 gray",children:"Stop this habit permanently and keep it for review in future",onClick:()=>J.value=!0})]})})]})}),u0({habit:Z,initialLevels:z,onChange:(B)=>Z.value=B})]),bottombar:W.Div({class:"bg-white w-100 pv3",children:[W.If({subject:Q,isTruthy:W.Div({class:"red mb3",children:Q})}),W.Div({class:"flex items-center justify-stretch",children:[x({className:"w4dot50 w4dot25-ns pa3 flex items-center",children:[h({iconName:"arrow_back"}),W.Span({class:"ml1",children:"Go Back"})],onTap:F}),x({className:"w-100 pa3 ml3 b",children:q(()=>X.value?"Save":"Update"),onTap:U})]})]})})})}),C=k(({classNames:X,title:$,child:J})=>{return W.Div({class:P`mt3 mb4 ${X}`,children:[W.Div({class:"mb2 dark-gray f4 b",children:$}),W.Div(J)]})}),p0=k(({classNames:X,iconSize:$,selectedOptionIndex:J,onChange:Q})=>{let Z=V(!1),z=q(()=>a[J.value]),Y=(U)=>{Q(U),Z.value=!1};return W.Div({class:X,children:[jX({classNames:"pointer",descending:q(()=>z.value.decending),iconName:q(()=>z.value.icon),size:q(()=>$?.value??20),onClick:()=>Z.value=!0}),t({classNames:"f5 normal ba bw0 outline-0",isOpen:Z,onTapOutside:()=>Z.value=!1,content:W.Div({children:[W.Div({class:"f5 b tc pv3",children:"Sort habit cards by"}),W.Div({class:"f5 mb1",children:W.For({subject:a,map:(U,F)=>{let R=P`pointer flex items-center pv3 pl2 pr3 bt b--moon-gray ${()=>U.label===z.value.label?"bg-near-white black":"gray"}`;return W.Div({class:R,onclick:T(()=>Y(F)),children:[jX({classNames:"ml1 mr2",descending:U.decending,iconName:U.icon,size:20}),W.Span(U.label)]})}})})]})})]})}),jX=k(({classNames:X,descending:$,iconName:J,size:Q,onClick:Z})=>{return W.Span({class:P`flex items-center ${()=>Z?"pointer":""} ${X}`,onclick:T(Z),children:[h({className:"silver",size:q(()=>4*Q.value/5),iconName:q(()=>$.value?"arrow_upward":"arrow_downward")}),h({className:"",size:Q,iconName:J})]})}),uX=q(()=>N.value.habitsPage.sortOptionIndex),pX=q(()=>N.value.habitsPage.tabIndex),e=q(()=>IX[pX.value].months),mX=V([]),WX=q(()=>{let X=a[uX.value],$=e.value,J=X.label,Q=mX.value.map((Z)=>({...Z,completion:O0(Z,$)}));return Q.sort((Z,z)=>{if(J==="Completion (Highest first)")return z.completion-Z.completion;if(J==="Completion (Lowest first)")return Z.completion-z.completion;if(J==="Date created (Oldest first)")return Z.id-z.id;return z.id-Z.id}),Q}),m0=q(()=>WX.value.filter((X)=>!X.isStopped)),DX=q(()=>WX.value.filter((X)=>X.isStopped)),s0=()=>{N0(),mX.value=S0()},r0=hX({classNames:"bg-near-white",onMount:s0,body:vX({classNames:"bg-near-white ph3",header:W.Div({class:"flex items-start justify-between",children:["Daily habits",p0({classNames:"mt2 mr2",iconSize:22,selectedOptionIndex:uX,onChange:(X)=>{let $=N.value;N.value={...$,habitsPage:{...$.habitsPage,sortOptionIndex:X}}}})]}),content:W.Div({children:[h0({classNames:"nl1 b f7 pb2 mb2 w-90",selectedTabClassNames:"pv3 br4",tabs:IX.map((X)=>X.label),selectedTabIndex:pX,onTabChange:(X)=>{let $=N.value;N.value={...$,habitsPage:{...$.habitsPage,tabIndex:X}}}}),W.If({subject:q(()=>WX.value.length),isFalsy:W.Div({class:"flex justify-around",children:W.Div({class:"mt6 pt5",children:"No habits added"})})}),W.Div({children:W.For({subject:m0,itemKey:"id",map:(X)=>KX({classNames:"mb3",habit:X,months:e,onClick:()=>location.href=`/habits/habit/?id=${X.value.id}`})})}),W.If({subject:q(()=>DX.value.length),isTruthy:W.Div(W.For({subject:DX,itemKey:"id",n:0,nthChild:W.Div({class:"silver f6 ml3 mt5 mb3",children:"OLD HABITS (DIE HARD)"}),map:(X)=>KX({classNames:"mb3",habit:X,months:e,onClick:()=>location.href=`/habits/habit/?id=${X.value.id}`})}))})]}),bottombar:W.Div({class:"w-100 flex justify-around",children:x({className:"pv3 ph4 mb3 shadow-4 b",children:"Add new habit",onTap:()=>location.href="/habits/new"})})})}),o0=()=>{O.start("mount"),LX.resetIdCounter(),r0(),O.start("run")};o0();
